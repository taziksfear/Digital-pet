=== –§–∞–π–ª: ./main.jsx ===
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.jsx'

createRoot(document.getElementById('root')).render(
  <StrictMode>
    <App />
  </StrictMode>,
)

--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./index.css ===
/* --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï –¢–ï–ú (–ë–µ–∂–µ–≤–∞—è –∏ –ì—Ä–∞—Ñ–∏—Ç–æ–≤–∞—è) --- */
:root.t-lgt { 
    --bg-g: linear-gradient(135deg, #f5f0e6 0%, #e8dfcf 100%); /* –ë–µ–∂–µ–≤—ã–π */
    --txt-c: #5c4d4d; 
    --pan-bg: rgba(255, 255, 255, 0.4); /* Liquid Glass */
    --pan-brd: rgba(255, 255, 255, 0.6);
    --btn-bg: rgba(0,0,0,0.06); 
    --ptrn: radial-gradient(rgba(0,0,0,0.05) 2px, transparent 2px);
}

:root.t-drk { 
    --bg-g: linear-gradient(135deg, #2c2f33 0%, #23272a 100%); /* –°–µ—Ä—ã–π/–ì—Ä–∞—Ñ–∏—Ç */
    --txt-c: #e0e0e0; 
    --pan-bg: rgba(20, 22, 25, 0.45); /* Liquid Glass */
    --pan-brd: rgba(255, 255, 255, 0.1);
    --btn-bg: rgba(255,255,255,0.1); 
    --ptrn: radial-gradient(rgba(255,255,255,0.05) 2px, transparent 2px);
}

/* --- –ë–ê–ó–ê --- */
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; -webkit-tap-highlight-color: transparent; }
body { background: var(--bg-g); color: var(--txt-c); transition: background 0.3s ease; height: 100vh; overflow: hidden; }
.app-cnt { height: 100vh; display: flex; flex-direction: column; position: relative; }

/* –ò–≥—Ä–æ–≤–∞—è –∑–æ–Ω–∞ */
.p-stg { flex-grow: 1; display: flex; justify-content: center; align-items: center; position: relative; flex-direction: column; }
canvas { background: transparent; width: 300px; height: 300px; z-index: 10; outline: none; }
.p-nm-lbl { position: absolute; top: 70px; font-weight: 900; font-size: 24px; color: var(--txt-c); z-index: 10; text-shadow: 0 2px 4px rgba(0,0,0,0.1); left: 50%; transform: translateX(-50%); }

/* LIQUID GLASS (–°—Ç–µ–∫–ª–æ) –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—à–µ–∫ */
.gls {
    background: var(--pan-bg); 
    backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); 
    border: 1px solid var(--pan-brd); 
    box-shadow: 0 8px 32px rgba(0,0,0,0.08);
}

.st-txt { font-size: 14px; font-weight: bold; color: #8ac6d1; padding: 4px 12px; border-radius: 20px; position: absolute; top: 110px; z-index: 20; opacity: 0; transition: 0.3s; pointer-events: none; }
.st-txt.vis { opacity: 1; }

.st-ovl { position: absolute; top: 20px; right: 20px; width: 160px; border-radius: 16px; padding: 12px; opacity: 0; transition: 0.4s; z-index: 20; }
.st-ovl.vis { opacity: 1; }
.st-grp { margin-bottom: 8px; }
.st-hdr { display: flex; justify-content: space-between; font-size: 12px; font-weight: 600; margin-bottom: 4px; }
.st-bar { height: 8px; background: var(--btn-bg); border-radius: 4px; overflow: hidden; }
.st-fl { height: 100%; transition: width 0.3s; }
.f-hng { background: #ffb6b9; } .f-eng { background: #fae3d9; } .f-md { background: #bbded6; }

.btm-isl { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); border-radius: 40px; padding: 10px 20px; display: flex; gap: 15px; z-index: 50; }
.d-btn { background: transparent; border: none; width: 50px; height: 50px; border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; transition: 0.2s; }
.d-btn:active { background: var(--btn-bg); transform: scale(0.9); } 
.d-btn.actv { background: rgba(138, 198, 209, 0.2); }
.d-btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }
.icn { font-size: 22px; } .lbl { font-size: 9px; margin-top: 4px; font-weight: 600; color: var(--txt-c); }

/* –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –Ω–∞—Ö—É–π –º–æ–¥–∞–ª–∫–∏!!!!!!!! */
.vw-wrp {
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    position: relative;
}

.v-scrn {
    width: 90%;
    max-width: 350px;
    background: var(--pan-bg);
    backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    border: 1px solid var(--pan-brd);
    border-radius: 24px;
    padding: 20px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    animation: fIn 0.3s ease-out forwards;
}

@keyframes fIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}

.bg-slp {
    background: var(--bg-g);
    filter: brightness(0.4) saturate(0.5); /* –ó–∞—Ç–µ–º–Ω—è–µ–º –∫–æ–º–Ω–∞—Ç—É –¥–ª—è —Å–Ω–∞ */
}

/* –í–∫–ª–∞–¥–∫–∏ */
.tbs { display: flex; background: var(--btn-bg); border-radius: 12px; padding: 4px; margin-bottom: 15px; }
.tb { flex: 1; padding: 8px; border: none; background: transparent; border-radius: 8px; font-weight: 600; color: var(--txt-c); opacity: 0.6; cursor: pointer; transition: 0.2s; }
.tb.act { background: var(--pan-bg); opacity: 1; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

/* –ö–∞—Ä—Ç–æ—á–∫–∏ */
.i-crd { background: var(--pan-bg); border: 2px solid transparent; border-radius: 16px; padding: 15px 5px; text-align: center; cursor: pointer; transition: 0.2s; backdrop-filter: blur(10px); }
.i-crd.sel, .i-crd:active { border-color: #8ac6d1; } .i-icn { font-size: 30px; } .i-nm { font-size: 11px; font-weight: bold; }

/* –ò–Ω–ø—É—Ç—ã –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ (iOS Style) */
.n-inp, .c-inp { padding: 12px; border-radius: 12px; border: 1px solid var(--pan-brd); background: var(--pan-bg); color: var(--txt-c); width: 100%; outline: none; margin-top: 8px; backdrop-filter: blur(10px); }
.d-btn-lg { width: 100%; padding: 14px; border-radius: 12px; background: #8ac6d1; color: #fff; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; }
.d-btn-lg:active { transform: scale(0.98); }
.s-row { display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 12px; background: var(--pan-bg); border-radius: 16px; border: 1px solid var(--pan-brd); backdrop-filter: blur(10px); }

/* iOS –°–≤–∏—Ç—á–µ—Ä */
.swch { position: relative; display: inline-block; width: 44px; height: 24px; }
.swch input { opacity: 0; width: 0; height: 0; }
.swch-sld { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--btn-bg); transition: .3s; border-radius: 24px; }
.swch-sld:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .3s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
input:checked + .swch-sld { background-color: #8ac6d1; }
input:checked + .swch-sld:before { transform: translateX(20px); }

/* –ü—Ä–∏–º–µ–Ω—è–µ–º Liquid Glass –∫ –Ω—É–∂–Ω—ã–º –±–ª–æ–∫–∞–º */
.st-ovl, .btm-isl, .st-txt { 
    background: var(--pan-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--pan-brd); box-shadow: 0 8px 32px rgba(0,0,0,0.08); 
}

/* --- –¢–£–¢–û–†–ò–ê–õ –ò –ü–û–ì–û–î–ê --- */
#t-ovl { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(3px); z-index: 999; display: none; opacity: 0; transition: 0.3s; pointer-events: none; }
#t-ovl.actv { display: block; opacity: 1; }
body.t-on .btm-isl, body.t-on .modl { z-index: 10000 !important; }
.t-hlt { position: relative; z-index: 10005 !important; pointer-events: auto !important; background: var(--pan-bg) !important; box-shadow: 0 0 20px rgba(255, 255, 255, 0.8) !important; }
#t-ptr { position: absolute; font-size: 50px; z-index: 10010; pointer-events: none; animation: bnc 0.8s infinite alternate; }
#t-msg { position: absolute; color: #fff; font-size: 16px; font-weight: bold; text-align: center; z-index: 10010; width: 250px; background: #8ac6d1; padding: 12px; border-radius: 12px; }
@keyframes bnc { to { transform: translateY(-15px); } }

.wx-cnt { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 5; overflow: hidden; }
.wx-pt { position: absolute; top: -10px; width: 4px; height: 4px; border-radius: 50%; }
.wx-pt.snw { background: #fff; box-shadow: 0 0 5px #fff; animation: fll linear infinite; }
.wx-pt.rn { background: #8ac6d1; width: 2px; height: 15px; border-radius: 2px; animation: fll linear infinite; }
@keyframes fll { to { transform: translateY(100vh) translateX(20px); opacity: 0; } }
.app-cnt {
    transition: background 0.8s ease, background-image 0.8s ease;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

/* 1. –î–û–ú (–ö–æ–º–Ω–∞—Ç–∞: –æ–±–æ–∏, –ø–ª–∏–Ω—Ç—É—Å, –æ–∫–Ω–æ –∏ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ CSS-–≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏) */
.bg-hm {
    /* –ß—Ç–æ–±—ã –≤—Å—Ç–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –ø–æ—Ç–æ–º, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π —ç—Ç—É —Å—Ç—Ä–æ–∫—É: */
    /* background-image: url('/public/img/home.png'); */
    
    background: 
        /* –û–∫–Ω–æ (–∫–≤–∞–¥—Ä–∞—Ç —Å–ø—Ä–∞–≤–∞) */
        linear-gradient(to right, rgba(255,255,255,0.4) 2px, transparent 2px) 240px 80px / 60px 80px no-repeat,
        linear-gradient(to bottom, rgba(255,255,255,0.4) 2px, transparent 2px) 240px 80px / 60px 80px no-repeat,
        linear-gradient(#8ac6d1, #8ac6d1) 240px 80px / 60px 80px no-repeat,
        
        /* –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ (—Å–µ—Ä—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Å–ª–µ–≤–∞) */
        linear-gradient(#d3dce6, #d3dce6) 20px 100px / 80px 140px no-repeat,
        
        /* –ü–ª–∏–Ω—Ç—É—Å –∏ –ø–æ–ª */
        linear-gradient(to bottom, transparent 240px, #8b7355 240px, #8b7355 250px, #d2b48c 250px, #d2b48c 100%) center 0 / 100% 100% no-repeat,
        
        /* –û–±–æ–∏ (—Ü–≤–µ—Ç –∏–∑ —Ç–µ–º—ã) */
        var(--bg-g);
}

/* 2. –£–õ–ò–¶–ê (–ò–≥—Ä–∞: –ù–µ–±–æ –∏ —Ç—Ä–∞–≤–∞) */
.bg-pl {
    /* background-image: url('/public/img/street.png'); */
    
    background: 
        /* –°–æ–ª–Ω—Ü–µ */
        radial-gradient(circle at 80% 20%, #ffd700 0%, #ffd700 20px, transparent 25px) center 0 / 100% 100% no-repeat,
        /* –¢—Ä–∞–≤–∞ –∏ –Ω–µ–±–æ */
        linear-gradient(to bottom, #87ceeb 0%, #87ceeb 240px, #7cfc00 240px, #32cd32 100%);
}

/* 3. –®–ö–ê–§ (–¢–µ–º–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –ø–æ–ª–∫–∏) */
.bg-wrd {
    /* background-image: url('/public/img/wardrobe.png'); */
    
    background: 
        /* –ü–æ–ª–∫–∏ */
        linear-gradient(to bottom, transparent 80px, #3e2723 80px, #3e2723 90px, transparent 90px, transparent 180px, #3e2723 180px, #3e2723 190px, transparent 190px) center 0 / 100% 100% no-repeat,
        
        /* –ó–∞–¥–Ω—è—è —Å—Ç–µ–Ω–∫–∞ —à–∫–∞—Ñ–∞ */
        linear-gradient(to right, #5d4037 0%, #4e342e 50%, #5d4037 100%);
}

/* –ó–∞—Ç–µ–º–Ω—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–æ–≥–¥–∞ –º—ã –Ω–∞ —É–ª–∏—Ü–µ –∏–ª–∏ –≤ —à–∫–∞—Ñ—É, —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç —á–∏—Ç–∞–ª—Å—è –ª—É—á—à–µ */
.bg-pl .lbl, .bg-wrd .lbl {
    color: #fff;
    text-shadow: 0 1px 3px rgba(0,0,0,0.8);
}


/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–æ–≥–æ–¥—ã */
@keyframes fall {
    0% {
        transform: translateY(-10vh) rotate(0deg);
    }
    100% {
        transform: translateY(110vh) rotate(360deg);
    }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-15px); }
    100% { transform: translateY(0px); }
}

@keyframes fillBar {
    from { width: 0%; }
    to { width: 100%; }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–ª–µ—Å–∞ —Ñ–æ—Ä—Ç—É–Ω—ã –∏ –º–æ–¥–∞–ª–æ–∫ */
.deal-wheel {
    --size: clamp(300px, 70vmin, 500px);
    --lg-hs: 0 3%;
    --lg-stop: 50%;
    --lg: linear-gradient(
        hsl(var(--lg-hs) 0%) 0 var(--lg-stop),
        hsl(var(--lg-hs) 20%) var(--lg-stop) 100%
    );
    
    position: relative;
    display: grid;
    grid-gap: calc(var(--size) / 20);
    align-items: center;
    grid-template-areas: "spinner" "trigger";
    font-size: calc(var(--size) / 21);
    margin: 0 auto;
}

.deal-wheel > * {
    grid-area: spinner;
}

.deal-wheel .btn-spin {
    grid-area: trigger;
    justify-self: center;
}

.spinner {
    position: relative;
    display: grid;
    align-items: center;
    grid-template-areas: "spinner";
    width: var(--size);
    height: var(--size);
    transform: rotate(calc(var(--rotate, 25) * 1deg));
    border-radius: 50%;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

.spinner * {
    grid-area: spinner;
}

.prize {
    display: flex;
    align-items: center;
    padding: 0 calc(var(--size) / 6) 0 calc(var(--size) / 20);
    width: 50%;
    height: 50%;
    transform-origin: center right;
    transform: rotate(var(--rotate));
    user-select: none;
}

.text {
    font-weight: 600;
    font-size: calc(var(--size) / 15);
    text-align: center;
    width: 100%;
    color: #333;
}

.ticker {
    position: relative;
    left: calc(var(--size) / -15);
    width: calc(var(--size) / 10);
    height: calc(var(--size) / 20);
    background: var(--lg);
    z-index: 1;
    clip-path: polygon(20% 0, 100% 50%, 20% 100%, 0% 50%);
    transform-origin: center left;
}

.is-spinning .spinner {
    transition: transform 3.5s cubic-bezier(0.1, 0.2, 0.35, 1);
}

.is-spinning .ticker {
    animation: tick 700ms cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes tick {
    40% {
        transform: rotate(-12deg);
    }
}

.prize.selected .text {
    color: white;
    animation: selected 800ms ease;
}

@keyframes selected {
    25% {
        transform: scale(1.25);
        text-shadow: 1vmin 1vmin 0 hsla(0 0% 0% / 0.1);
    }
    40% {
        transform: scale(0.92);
        text-shadow: 0 0 0 hsla(0 0% 0% / 0.2);
    }
    60% {
        transform: scale(1.02);
        text-shadow: 0.5vmin 0.5vmin 0 hsla(0 0% 0% / 0.1);
    }
    75% {
        transform: scale(0.98);
    }
    85% {
        transform: scale(1);
    }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –≤ –≥–∞—Ä–¥–µ—Ä–æ–±–µ */
.wardrobe-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 15px;
    max-height: 60vh;
    overflow-y: auto;
}

.character-card {
    background: var(--pan-bg);
    border: 2px solid transparent;
    border-radius: 16px;
    padding: 15px;
    text-align: center;
    transition: transform 0.2s;
    cursor: pointer;
    backdrop-filter: blur(10px);
    position: relative;
}

.character-card.unlocked:hover {
    transform: scale(1.05);
}

.character-card.selected {
    border-color: #8ac6d1;
}

.character-icon {
    font-size: 40px;
    margin-bottom: 10px;
}

.character-name {
    font-weight: bold;
    margin-bottom: 10px;
}

.lock-icon {
    font-size: 24px;
    margin-bottom: 5px;
}

.unlock-btn {
    background: #8ac6d1;
    border: none;
    color: white;
    padding: 8px 12px;
    border-radius: 20px;
    cursor: pointer;
    font-weight: bold;
    width: 100%;
}

.selected-badge {
    margin-top: 8px;
    color: #8ac6d1;
    font-weight: bold;
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/WardrobeModal.jsx ===
import React from 'react';

const CHARACTERS = [
    { id: 'twilight', name: '–ò—Å–∫–æ—Ä–∫–∞', icon: 'ü¶Ñ', rarity: '–î–µ—Ñ–æ–ª—Ç', color: '#9b59b6' },
    { id: 'rick', name: '–†–∏–∫', icon: 'üë®‚Äçüî¨', rarity: '–û–±—ã—á–Ω–∞—è', color: '#bdc3c7' },
    { id: 'alien',  rarity: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è', name: '–ò–Ω–æ–ø—Ä–µ—à–µ–ª–µ–Ω–µ—Ü', color: '#15ff00', icon: 'üëΩ' },
    { id: 'mannequin', rarity: '–≠–ø–∏—á–µ—Å–∫–∞—è', name: '–ú–∞–Ω–∏–∫–µ–Ω', color: '#0080ff', icon: 'üë§' },
    { id: 'robot', rarity: '–≠–ø–∏—á–µ—Å–∫–∞—è', name: '–†–æ–±–æ—Ç', color: '#0080ff', icon: 'ü§ñ'},
    { id: 'zombie', rarity:'—Ä–µ–¥–∫–∞—è', name: '–ó–æ–º–±–∏', color: '#9b59b6', icon: 'üßü'}
];

export default function WardrobeModal({ isOpen, onClose, unlockedCharacters, currentCharacter, onSelect, onUnlockRequest, l, colors }) {
    if (!isOpen) return null;

    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.6)', zIndex: 1000, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
            <div style={{ background: colors.modalBg, backdropFilter: 'blur(20px)', border: `1px solid ${colors.border}`, padding: '25px', borderRadius: '25px', width: '90%', maxWidth: '400px', color: colors.text, boxShadow: colors.shadow }}>
                
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h2 style={{ margin: 0 }}>{l.wardrobe}</h2>
                    <button onClick={onClose} style={{ background: colors.border, border: 'none', width: '30px', height: '30px', borderRadius: '50%', color: colors.text, cursor: 'pointer' }}>‚úñ</button>
                </div>

                <div style={{ display: 'flex', flexDirection: 'column', gap: '15px', maxHeight: '50vh', overflowY: 'auto', paddingRight: '5px' }}>
                    {CHARACTERS.map(char => {
                        const isUnlocked = unlockedCharacters.includes(char.id);
                        const isSelected = currentCharacter === char.id;

                        return (
                            <div key={char.id} style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', background: colors.glassBg, border: `2px solid ${isSelected ? '#2ecc71' : colors.border}`, borderRadius: '15px', padding: '10px 15px', opacity: isUnlocked ? 1 : 0.7 }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '15px' }}>
                                    <div style={{ fontSize: '30px', background: 'rgba(255,255,255,0.2)', padding: '10px', borderRadius: '12px', border: `1px solid ${char.color}`, boxShadow: `0 0 10px ${char.color}40` }}>
                                        {char.icon}
                                    </div>
                                    <div>
                                        <h3 style={{ margin: 0, fontSize: '18px' }}>{char.name}</h3>
                                        <span style={{ fontSize: '12px', color: char.color, fontWeight: 'bold' }}>{char.rarity}</span>
                                    </div>
                                </div>

                                {isUnlocked ? (
                                    <button 
                                        onClick={() => onSelect(char.id)} disabled={isSelected}
                                        style={{ background: isSelected ? '#2ecc71' : '#3498db', border: 'none', color: 'white', padding: '8px 15px', borderRadius: '20px', fontWeight: 'bold', cursor: isSelected ? 'default' : 'pointer' }}
                                    >
                                        {isSelected ? '–ù–∞–¥–µ—Ç–æ' : '–í—ã–±—Ä–∞—Ç—å'}
                                    </button>
                                ) : (
                                    <button 
                                        onClick={onUnlockRequest}
                                        style={{ background: '#e74c3c', border: 'none', color: 'white', padding: '8px 15px', borderRadius: '20px', fontWeight: 'bold', cursor: 'pointer', boxShadow: '0 4px 10px rgba(231, 76, 60, 0.4)' }}
                                    >
                                        üîí –í—ã–±–∏—Ç—å
                                    </button>
                                )}
                            </div>
                        );
                    })}
                </div>

                <button onClick={onUnlockRequest} style={{ width: '100%', marginTop: '20px', padding: '15px', background: 'linear-gradient(135deg, #f1c40f, #e67e22)', color: 'white', border: 'none', borderRadius: '20px', fontWeight: 'bold', fontSize: '16px', cursor: 'pointer', boxShadow: '0 4px 15px rgba(230, 126, 34, 0.5)' }}>
                    üé∞ –†—É–ª–µ—Ç–∫–∞ –ü–µ—Ä—Å–æ–Ω–∞–∂–µ–π
                </button>
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/AppModals.jsx ===
import React from 'react';
import { ToggleSwitch } from './SharedUI';

export function SettingsModal({ onClose, l, colors, theme, setTheme, language, setLanguage, city, setCity, fetchWeather, isDark, isDevMode, setIsDevMode }) {
    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.4)', zIndex: 1000, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
            <div style={{ background: colors.modalBg, backdropFilter: 'blur(20px)', border: `1px solid ${colors.border}`, boxShadow: colors.shadow, padding: '25px', borderRadius: '25px', width: '85%', maxWidth: '320px', color: colors.text }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '25px' }}>
                    <h2 style={{ margin: 0, fontSize: '22px' }}>{l.settings}</h2>
                    <button onClick={onClose} style={{ background: colors.border, border: 'none', fontSize: '18px', width: '30px', height: '30px', borderRadius: '50%', color: colors.text, cursor: 'pointer' }}>‚úñ</button>
                </div>
                <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}><span style={{ fontWeight: 'bold' }}>{l.theme}:</span><ToggleSwitch isOn={isDark} onToggle={() => setTheme(isDark ? 'lgt' : 'drk')} iconOn="üåô" iconOff="‚òÄÔ∏è" isDark={isDark} /></div>
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}><span style={{ fontWeight: 'bold' }}>{l.lang}:</span><ToggleSwitch isOn={language === 'en'} onToggle={() => setLanguage(language === 'ru' ? 'en' : 'ru')} iconOn="EN" iconOff="RU" isDark={isDark} /></div>
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}><span style={{ fontWeight: 'bold' }}>{l.city}:</span><input type="text" value={city} onChange={e => setCity(e.target.value)} onBlur={fetchWeather} style={{ background: isDark ? 'rgba(0,0,0,0.3)' : 'rgba(255,255,255,0.5)', border: `1px solid ${colors.border}`, color: colors.text, padding: '8px', borderRadius: '12px', width: '100px', textAlign: 'center' }} /></div>
                </div>
                <hr style={{ margin: '25px 0', borderColor: colors.border }} />
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', background: isDark ? 'rgba(255,0,0,0.1)' : 'rgba(255,0,0,0.05)', padding: '10px 15px', borderRadius: '15px', border: `1px solid ${colors.border}` }}>
                    <span style={{ fontWeight: 'bold', color: '#ff7675' }}>üõ† {l.devMode}</span><ToggleSwitch isOn={isDevMode} onToggle={() => setIsDevMode(!isDevMode)} iconOn="ON" iconOff="OFF" isDark={isDark} />
                </div>
            </div>
        </div>
    );
}

export function ShopModal({ onClose, l, colors, handlePurchase }) {
    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.4)', zIndex: 1000, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
            <div style={{ background: colors.modalBg, backdropFilter: 'blur(20px)', border: `1px solid ${colors.border}`, boxShadow: colors.shadow, padding: '25px', borderRadius: '25px', width: '90%', maxWidth: '650px', color: colors.text }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h2 style={{ margin: 0, fontSize: '22px' }}>{l.shop}</h2>
                    <button onClick={onClose} style={{ background: colors.border, border: 'none', width: '30px', height: '30px', borderRadius: '50%', color: colors.text, cursor: 'pointer' }}>‚úñ</button>
                </div>
                <div style={{ display: 'flex', justifyContent: 'center', gap: '15px', flexWrap: 'wrap' }}>
                    <div style={{ background: colors.glassBg, border: `1px solid ${colors.border}`, borderRadius: '16px', padding: '15px', width: '140px', textAlign: 'center' }}>
                        <h3 style={{ margin: '10px 0 5px' }}>–ì–æ—Ä—Å—Ç—å</h3>
                        <p>100 {l.coins}</p>
                        <button onClick={() => handlePurchase(100)} style={{ background: '#8ac6d1', border: 'none', color: 'white', padding: '8px 12px', borderRadius: '20px', cursor: 'pointer', width: '100%' }}>{l.buy}</button>
                    </div>
                    <div style={{ background: colors.glassBg, border: `1px solid ${colors.border}`, borderRadius: '16px', padding: '15px', width: '140px', textAlign: 'center' }}>
                        <h3 style={{ margin: '10px 0 5px' }}>–ú–µ—à–æ–∫</h3>
                        <p>500 {l.coins}</p>
                        <button onClick={() => handlePurchase(500)} style={{ background: '#8ac6d1', border: 'none', color: 'white', padding: '8px 12px', borderRadius: '20px', cursor: 'pointer', width: '100%' }}>{l.buy}</button>
                    </div>
                </div>
            </div>
        </div>
    );
}

export function GamesModal({ onClose, l, colors, handleGameSelect, openSlots }) {
    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.4)', zIndex: 1000, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
            <div style={{ background: colors.modalBg, backdropFilter: 'blur(20px)', border: `1px solid ${colors.border}`, padding: '25px', borderRadius: '25px', width: '85%', maxWidth: '350px', color: colors.text }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h2 style={{ margin: 0 }}>{l.gamesModalTitle}</h2>
                    <button onClick={onClose} style={{ background: colors.border, border: 'none', width: '30px', height: '30px', borderRadius: '50%', color: colors.text, cursor: 'pointer' }}>‚úñ</button>
                </div>
                
                <div style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>
                    <div 
                        onClick={openSlots} 
                        style={{ background: 'linear-gradient(135deg, #f39c12, #d35400)', border: `1px solid ${colors.border}`, borderRadius: '16px', padding: '15px', display: 'flex', justifyContent: 'center', alignItems: 'center', cursor: 'pointer', boxShadow: '0 4px 15px rgba(211, 84, 0, 0.4)' }}
                    >
                        <span style={{ fontWeight: 'bold', color: '#fff', fontSize: '18px' }}>üé∞ –î–µ–Ω–µ–∂–Ω—ã–µ –°–ª–æ—Ç—ã</span>
                    </div>

                    
                </div>
            </div>
        </div>
    );
}
export function QuestsModal({ onClose, l, colors, quests, claimQuestReward, claimingQuestId }) {
    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.4)', zIndex: 1000, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
            <div style={{ background: colors.modalBg, backdropFilter: 'blur(20px)', border: `1px solid ${colors.border}`, padding: '25px', borderRadius: '25px', width: '90%', maxWidth: '500px', color: colors.text }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h2 style={{ margin: 0 }}>{l.questsModalTitle}</h2>
                    <button onClick={onClose} style={{ background: colors.border, border: 'none', width: '30px', height: '30px', borderRadius: '50%', color: colors.text, cursor: 'pointer' }}>‚úñ</button>
                </div>
                <div style={{ display: 'flex', flexDirection: 'column', gap: '15px', maxHeight: '60vh', overflowY: 'auto' }}>
                    {quests.map(q => (
                        <div key={q.id} style={{ background: colors.glassBg, border: `1px solid ${colors.border}`, borderRadius: '16px', padding: '15px', opacity: q.claimed ? 0.6 : 1, display: 'flex', justifyContent: 'space-between' }}>
                            <div>
                                <h3 style={{ margin: 0, fontSize: '16px' }}>{l[q.titleKey]}</h3>
                                <p style={{ margin: '5px 0', fontSize: '14px' }}>{q.progress}/{q.target}</p>
                            </div>
                            <div style={{ textAlign: 'right' }}>
                                <p style={{ margin: '0 0 5px', color: '#ffaa00' }}>+{q.reward}üí∞</p>
                                {q.completed && !q.claimed && (
                                    <button onClick={() => claimQuestReward(q.id)} disabled={claimingQuestId === q.id} style={{ background: '#8ac6d1', border: 'none', color: 'white', padding: '5px 12px', borderRadius: '20px', cursor: 'pointer' }}>{l.claim}</button>
                                )}
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        </div>
    );
}

export function VoiceModal({ onClose, l, colors, isRecording, startRecording, stopRecording, audioUrl, sendRecording, isSending, restartRecording, cancelRecording }) {
    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.4)', zIndex: 1100, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
            <div style={{ background: colors.modalBg, backdropFilter: 'blur(20px)', border: `1px solid ${colors.border}`, padding: '25px', borderRadius: '25px', width: '85%', maxWidth: '400px', color: colors.text }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h2 style={{ margin: 0 }}>{l.voiceModalTitle}</h2>
                    <button onClick={cancelRecording} style={{ background: colors.border, border: 'none', width: '30px', height: '30px', borderRadius: '50%', color: colors.text, cursor: 'pointer' }}>‚úñ</button>
                </div>
                {!audioUrl ? (
                    <div style={{ textAlign: 'center' }}>
                        {isRecording ? (
                            <div>
                                <p style={{ color: '#ff6b6b', fontWeight: 'bold' }}>{l.recording}</p>
                                <button onClick={stopRecording} style={{ margin: '10px', padding: '10px 20px', background: '#ff6b6b', border: 'none', borderRadius: '20px', color: 'white', cursor: 'pointer' }}>{l.stopRecord}</button>
                            </div>
                        ) : (
                            <button onClick={startRecording} style={{ padding: '10px 20px', background: '#8ac6d1', border: 'none', borderRadius: '20px', color: 'white', cursor: 'pointer' }}>{l.startRecord}</button>
                        )}
                    </div>
                ) : (
                    <div>
                        <audio controls src={audioUrl} style={{ width: '100%', marginBottom: '15px' }} />
                        <div style={{ display: 'flex', gap: '10px', justifyContent: 'center' }}>
                            <button onClick={sendRecording} disabled={isSending} style={{ padding: '10px 20px', background: '#4caf50', border: 'none', borderRadius: '20px', color: 'white', cursor: 'pointer' }}>{l.send}</button>
                            <button onClick={restartRecording} style={{ padding: '10px 20px', background: '#ffaa00', border: 'none', borderRadius: '20px', color: 'white', cursor: 'pointer' }}>{l.restart}</button>
                        </div>
                    </div>
                )}
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/NameModal.jsx ===
import React, { useState } from 'react';

export default function NameModal({ text, saveName }) {
    const [v, setV] = useState('');

    return (
        <div className="modl opn" style={{ zIndex: 2000 }}>
            <div className="m-hdr">
                <h3>{text.nm_q}</h3>
            </div>
            
            <div className="m-cnt" style={{ display: 'flex', flexDirection: 'column', gap: '15px', padding: '20px' }}>
                <input 
                    className="n-inp" 
                    value={v} 
                    onChange={e => setV(e.target.value)} 
                    placeholder="Name..." 
                />
                
                <button 
                    className="d-btn-lg" 
                    onClick={() => { if (v) saveName(v); }}
                >
                    {text.sv}
                </button>
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/BottomDock.jsx ===
import React from 'react';

export default function BottomDock({ currentView, handleNavigation, text, tutStep }) {
    return (
        <div className="btm-isl">
            <button 
                id="btn-hm" 
                className={`d-btn ${currentView === 'home' ? 'actv' : ''} ${tutStep === 2 ? 't-hlt' : ''}`} 
                onClick={() => handleNavigation('home')}
                disabled={tutStep > 0 && tutStep !== 2}
            >
                <span className="icn">üè†</span>
                <span className="lbl">{text.hm}</span>
            </button>

            <button 
                id="btn-pl" 
                className={`d-btn ${currentView === 'play' ? 'actv' : ''} ${tutStep === 1 ? 't-hlt' : ''}`} 
                onClick={() => handleNavigation('play')}
                disabled={tutStep > 0 && tutStep !== 1}
            >
                <span className="icn">üéæ</span>
                <span className="lbl">{text.pl}</span>
            </button>

            <button 
                id="btn-slp" 
                className={`d-btn ${currentView === 'sleep' ? 'actv' : ''} ${tutStep === 3 ? 't-hlt' : ''}`} 
                onClick={() => handleNavigation('sleep')}
                disabled={tutStep > 0 && tutStep !== 3}
            >
                <span className="icn">üåô</span>
                <span className="lbl">{text.slp}</span>
            </button>

            <button 
                id="btn-tlt" 
                className={`d-btn ${currentView === 'toilet' ? 'actv' : ''}`} 
                onClick={() => handleNavigation('toilet')}
                disabled={tutStep > 0}
            >
                <span className="icn">üöΩ</span>
                <span className="lbl">{text.tlt || '–¢—É–∞–ª–µ—Ç'}</span>
            </button>

            <button 
                className={`d-btn ${currentView === 'settings' ? 'actv' : ''}`} 
                onClick={() => handleNavigation('settings')}
                disabled={tutStep > 0}
            >
                <span className="icn">‚öôÔ∏è</span>
                <span className="lbl">{text.stg}</span>
            </button>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/WeatherOverlay.jsx ===
import React from 'react';

export default function WeatherOverlay({ weather }) {
    if (weather === 'clr') return null;

    const pts = Array.from({ length: 20 }).map((_, i) => (
        <div 
            key={i} 
            className={`wx-pt ${weather}`} 
            style={{ 
                left: `${Math.random() * 100}%`, 
                animationDuration: `${Math.random() * 2 + 1}s`, 
                animationDelay: `${Math.random()}s` 
            }} 
        />
    ));

    return (
        <div className="wx-cnt">
            {pts}
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/Takoyaki.jsx ===
import React from 'react';

export default function Takoyaki({ style, onPointerDown, onPointerMove, onPointerUp }) {
    return (
        <div 
            onPointerDown={onPointerDown}
            onPointerMove={onPointerMove}
            onPointerUp={onPointerUp}
            style={{
                width: '80px', height: '80px', cursor: 'grab',
                userSelect: 'none', WebkitUserSelect: 'none', touchAction: 'none',
                filter: 'drop-shadow(0px 8px 6px rgba(0,0,0,0.4))',
                ...style
            }}
        >
            <svg viewBox="0 0 100 100" width="100%" height="100%">
                {/* –®–∞—Ä–∏–∫ –∏–∑ —Ç–µ—Å—Ç–∞ */}
                <circle cx="50" cy="50" r="45" fill="#e5b05c" />
                <circle cx="50" cy="50" r="45" fill="radial-gradient(circle, transparent 40%, rgba(139,69,19,0.4) 100%)" />
                
                {/* –°–æ—É—Å —Ç–µ—Ä–∏—è–∫–∏ */}
                <path d="M 15 45 Q 30 20 60 30 T 85 45 Q 90 70 70 80 T 30 75 Q 10 60 15 45" fill="#4a2511" />
                
                {/* –ü–æ–ª–æ—Å–∫–∏ –º–∞–π–æ–Ω–µ–∑–∞ */}
                <path d="M 10 35 Q 50 10 90 45" stroke="#fffacd" strokeWidth="5" fill="none" strokeLinecap="round"/>
                <path d="M 15 55 Q 50 30 85 65" stroke="#fffacd" strokeWidth="5" fill="none" strokeLinecap="round"/>
                <path d="M 25 75 Q 50 50 75 85" stroke="#fffacd" strokeWidth="5" fill="none" strokeLinecap="round"/>
                
                {/* –ó–µ–ª–µ–Ω–∞—è –ø–æ—Å—ã–ø–∫–∞ (–Ω–æ—Ä–∏) */}
                <circle cx="35" cy="30" r="2.5" fill="#2e4c16" />
                <circle cx="65" cy="40" r="3" fill="#2e4c16" />
                <circle cx="45" cy="60" r="2" fill="#2e4c16" />
                <circle cx="75" cy="60" r="2.5" fill="#2e4c16" />
                <circle cx="50" cy="80" r="2" fill="#2e4c16" />
                <circle cx="30" cy="50" r="1.5" fill="#2e4c16" />
            </svg>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/WheelOfFortune.jsx ===
import React, { useState, useEffect } from 'react';

const PRIZES = [
    { id: 'rick', type: 'char', name: '–†–∏–∫', color: '#bdc3c7', icon: 'üë®‚Äçüî¨', chance: 20 },
    { id: 'twilight', type: 'char', name: '–ò—Å–∫–æ—Ä–∫–∞', color: '#9b59b6', icon: 'ü¶Ñ', chance: 10 },
    { id: 'alien', type: 'char', name: '–ò–Ω–æ–ø—Ä–µ—à–µ–ª–µ–Ω–µ—Ü', color: '#9b59b6', icon: 'üëΩ', chance: 5 },
    { id: 'mannequin', type: 'char', name: '–ú–∞–Ω–∏–∫–µ–Ω', color: '#9b59b6', icon: 'üë§', chance: 10 },
    { id: 'robot', type: 'char', name: '–†–æ–±–æ—Ç', color: '#9b59b6', icon: 'ü§ñ', chance: 10 },
    { id: 'zombie', type: 'char', name: '–ó–æ–º–±–∏', color: '#9b59b6', icon: 'üßü', chance: 15 },
    { id: 'coin_50', type: 'coin', amount: 50, name: '50 –ú–æ–Ω–µ—Ç', color: '#f1c40f', icon: 'ü™ô', chance: 25 },
    { id: 'coin_200', type: 'coin', amount: 200, name: '200 –ú–æ–Ω–µ—Ç', color: '#2ecc71', icon: 'üíé', chance: 15 },
];

export default function WheelOfFortune({ isOpen, onClose, balance, setBalance, sendAction, unlockedCharacters, onUnlock, colors }) {
    const SPIN_COST = 200;
    const ITEM_WIDTH = 130; // 120px —à–∏—Ä–∏–Ω–∞ –±–ª–æ–∫–∞ + 10px –æ—Ç—Å—Ç—É–ø (gap)
    
    const [isSpinning, setIsSpinning] = useState(false);
    const [strip, setStrip] = useState([]);
    const [result, setResult] = useState(null);
    const [isDuplicate, setIsDuplicate] = useState(false);
    const [offset, setOffset] = useState(0); // –ù–∞—à –Ω–æ–≤—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π —è–∫–æ—Ä—å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏

    useEffect(() => {
        if (isOpen) {
            setStrip(Array.from({ length: 10 }, () => PRIZES[Math.floor(Math.random() * PRIZES.length)]));
            setResult(null);
            setOffset(0); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é
            setIsDuplicate(false);
        }
    }, [isOpen]);

    const getWinPrize = () => {
        const roll = Math.random() * 100;
        let currentSum = 0;
        for (const p of PRIZES) {
            currentSum += p.chance;
            if (roll <= currentSum) return p;
        }
        return PRIZES[0];
    };

    const handleSpin = () => {
        if (balance < SPIN_COST || isSpinning) return;

        setBalance(prev => prev - SPIN_COST);
        sendAction('balance_add', `-${SPIN_COST}`);
        
        setIsSpinning(false); // –í—ã–∫–ª—é—á–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è —Å–±—Ä–æ—Å–∞
        setResult(null);
        setIsDuplicate(false);
        setOffset(0); // –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ª–µ–Ω—Ç—É –≤ –Ω–∞—á–∞–ª–æ

        const win = getWinPrize();
        
        const newStrip = [];
        for (let i = 0; i < 40; i++) {
            newStrip.push(PRIZES[Math.floor(Math.random() * PRIZES.length)]);
        }
        newStrip.push(win); // –ü–æ–±–µ–¥–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –±—É–¥–µ—Ç —Ä–æ–≤–Ω–æ 40-–º –∏–Ω–¥–µ–∫—Å–æ–º
        newStrip.push(PRIZES[Math.floor(Math.random() * PRIZES.length)]);
        newStrip.push(PRIZES[Math.floor(Math.random() * PRIZES.length)]);

        setStrip(newStrip);

        // –î–∞–µ–º React –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—É –Ω–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫—É –ª–µ–Ω—Ç—ã, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª–µ—Ç
        setTimeout(() => {
            setIsSpinning(true);
            setOffset(40 * ITEM_WIDTH); // –î–≤–∏–≥–∞–µ–º –ª–µ–Ω—Ç—É —Ä–æ–≤–Ω–æ –¥–æ 40-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        }, 50);

        // –ñ–¥–µ–º 4 —Å–µ–∫—É–Ω–¥—ã –ø–æ–∫–∞ —Ä—É–ª–µ—Ç–∫–∞ –∫—Ä—É—Ç–∏—Ç—Å—è
        setTimeout(() => {
            setIsSpinning(false);
            setResult(win);
            
            if (win.type === 'char') {
                if (unlockedCharacters.includes(win.id)) {
                    setIsDuplicate(true);
                    setBalance(prev => prev + 150);
                    sendAction('balance_add', '150');
                } else {
                    onUnlock(win.id);
                }
            } else if (win.type === 'coin') {
                setBalance(prev => prev + win.amount);
                sendAction('balance_add', win.amount.toString());
            }
        }, 4050); 
    };

    if (!isOpen) return null;

    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.8)', zIndex: 1200, display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center' }}>
            
            <button onClick={onClose} disabled={isSpinning} style={{ position: 'absolute', top: '20px', right: '20px', background: 'transparent', border: '2px solid white', color: 'white', borderRadius: '50%', width: '40px', height: '40px', fontSize: '20px', cursor: isSpinning ? 'not-allowed' : 'pointer' }}>‚úñ</button>

            <div style={{ position: 'absolute', top: '20px', left: '20px', background: 'rgba(0,0,0,0.6)', padding: '10px 20px', borderRadius: '20px', fontSize: '20px', fontWeight: 'bold', border: '2px solid #f1c40f', color: '#f1c40f' }}>
                üí∞ {balance}
            </div>

            <h1 style={{ color: 'white', textTransform: 'uppercase', letterSpacing: '2px', textShadow: '0 0 20px rgba(255,255,255,0.5)', marginBottom: '30px' }}>
                –ü–æ–∏—Å–∫ –ü–µ—Ä—Å–æ–Ω–∞–∂–∞
            </h1>

            <div style={{ width: '90%', maxWidth: '500px', height: '140px', background: '#2c3e50', borderRadius: '20px', border: '4px solid #34495e', overflow: 'hidden', position: 'relative', boxShadow: '0 15px 30px rgba(0,0,0,0.8)' }}>
                
                <div style={{ position: 'absolute', top: 0, left: '50%', width: '4px', height: '100%', background: '#e74c3c', zIndex: 10, transform: 'translateX(-50%)', boxShadow: '0 0 15px #e74c3c' }} />
                
                {/* --- –ù–û–í–ê–Ø –ñ–ï–õ–ï–ó–û–ë–ï–¢–û–ù–ù–ê–Ø –ê–ù–ò–ú–ê–¶–ò–Ø --- */}
                <div style={{ 
                    display: 'flex', height: '100%', alignItems: 'center', gap: '10px', 
                    paddingLeft: 'calc(50% - 60px)', // –ò–¥–µ–∞–ª—å–Ω–æ —Ü–µ–Ω—Ç—Ä—É–µ—Ç –Ω—É–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç
                    transform: `translateX(-${offset}px)`,
                    transition: isSpinning ? 'transform 4s cubic-bezier(0.1, 0.8, 0.1, 1)' : 'none'
                }}>
                    {strip.map((item, index) => (
                        <div key={index} style={{ 
                            minWidth: '120px', height: '120px', background: 'linear-gradient(135deg, #34495e, #2c3e50)', 
                            borderRadius: '15px', border: `2px solid ${item.color}`, display: 'flex', flexDirection: 'column', 
                            justifyContent: 'center', alignItems: 'center', boxShadow: `inset 0 0 20px ${item.color}30` 
                        }}>
                            <div style={{ fontSize: '50px' }}>{item.icon}</div>
                        </div>
                    ))}
                </div>
            </div>

            <button 
                onClick={handleSpin} disabled={isSpinning || balance < SPIN_COST}
                style={{
                    marginTop: '40px', padding: '15px 50px', fontSize: '22px', fontWeight: 'bold', textTransform: 'uppercase',
                    background: isSpinning ? '#7f8c8d' : (balance >= SPIN_COST ? 'linear-gradient(180deg, #9b59b6 0%, #8e44ad 100%)' : '#7f8c8d'),
                    color: 'white', border: '4px solid rgba(255,255,255,0.2)', borderRadius: '40px',
                    cursor: (isSpinning || balance < SPIN_COST) ? 'not-allowed' : 'pointer',
                    boxShadow: isSpinning ? 'none' : '0 10px 20px rgba(142, 68, 173, 0.5)',
                    transform: isSpinning ? 'scale(0.95)' : 'scale(1)', transition: 'all 0.2s ease'
                }}
            >
                {isSpinning ? '–û—Ç–∫—Ä—ã–≤–∞–µ–º...' : `–û—Ç–∫—Ä—ã—Ç—å (${SPIN_COST} üí∞)`}
            </button>

            <div style={{ height: '100px', marginTop: '20px', display: 'flex', alignItems: 'center' }}>
                {result && !isSpinning && (
                    <div style={{ animation: 'popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)', textAlign: 'center', background: 'rgba(0,0,0,0.6)', padding: '15px 40px', borderRadius: '20px', border: `2px solid ${result.color}` }}>
                        <div style={{ fontSize: '30px', fontWeight: 'bold', color: result.color, textShadow: `0 0 15px ${result.color}80` }}>
                            {result.icon} {result.name}
                        </div>
                        {isDuplicate && <div style={{ color: '#f1c40f', marginTop: '5px', fontWeight: 'bold' }}>–£–∂–µ –µ—Å—Ç—å! –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è: +150 üí∞</div>}
                        {result.type === 'char' && !isDuplicate && <div style={{ color: '#2ecc71', marginTop: '5px', fontWeight: 'bold' }}>–ù–û–í–´–ô –ü–ï–†–°–û–ù–ê–ñ!</div>}
                    </div>
                )}
            </div>

            <style>{`@keyframes popIn { 0% { transform: scale(0.5) translateY(20px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }`}</style>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/PetPlayer.jsx ===
import React, { useLayoutEffect, useMemo, useRef } from 'react';
import { useGLTF, useAnimations } from '@react-three/drei';
import * as THREE from 'three';
import * as SkeletonUtils from 'three/addons/utils/SkeletonUtils.js';

export default function PetPlayer({ url, position = [0, -3.0, 0], rotation = [0, 0, 0], scale = 2.2, loop = true, onInteract }) {
    const group = useRef();
    const { scene, animations } = useGLTF(url);
    const clonedScene = useMemo(() => SkeletonUtils.clone(scene), [scene]);
    const { actions, mixer } = useAnimations(animations, group);

    useLayoutEffect(() => {
        if (!animations || animations.length === 0) return;

        const actionName = animations[0].name;
        const action = actions[actionName];

        if (action) {
            action.reset();
            if (!loop) {
                action.setLoop(THREE.LoopOnce, 1);
                action.clampWhenFinished = true;
            } else {
                action.setLoop(THREE.LoopRepeat, Infinity);
            }
            
            action.play();
            mixer.update(0);
        }

        return () => {
            if (action) action.stop();
        };
    }, [url, actions, mixer, loop, animations]);

    return (
        <group ref={group} dispose={null} onClick={onInteract}>
            <primitive object={clonedScene} position={position} rotation={rotation} scale={scale} />
        </group>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/Wardobe.jsx ===
import React, { useState } from 'react';

export default function Wardrobe({ currentCharacter, currentCostume, onAction }) {
    const [activeTab, setActiveTab] = useState('chars'); // 'chars' –∏–ª–∏ 'costumes'

    return (
        <div className="wardrobe-container">
            <div className="tabs-container">
                <button 
                    className={`tab-btn ${activeTab === 'chars' ? 'active' : ''}`} 
                    onClick={() => setActiveTab('chars')}
                >–ü–µ—Ä—Å–æ–Ω–∞–∂–∏</button>
                <button 
                    className={`tab-btn ${activeTab === 'costumes' ? 'active' : ''}`} 
                    onClick={() => setActiveTab('costumes')}
                >–ö–æ—Å—Ç—é–º—ã</button>
            </div>

            {activeTab === 'chars' && (
                <div className="grid-layout active">
                    <div className={`item-card ${currentCharacter === 'pig' ? 'selected' : ''}`}>
                        <div className="item-icon">üê∑</div><div className="item-name">–°–≤–∏–Ω–∫–∞</div>
                    </div>
                </div>
            )}

            {/* –í–∫–ª–∞–¥–∫–∞: –ö–æ—Å—Ç—é–º—ã */}
            {activeTab === 'costumes' && (
                <div className="grid-layout active">
                    <div 
                        id="costume-santa" 
                        className={`item-card ${currentCostume === 'santa' ? 'selected' : ''}`} 
                        onClick={() => onAction('equip_santa')}
                    >
                        <div className="item-icon">üéÖ</div><div className="item-name">–ö–æ–ª–ø–∞–∫</div>
                    </div>
                    <div 
                        className={`item-card ${currentCostume === 'none' ? 'selected' : ''}`} 
                        onClick={() => onAction('equip_none')}
                    >
                        <div className="item-icon">‚ùå</div><div className="item-name">–°–Ω—è—Ç—å –≤—Å—ë</div>
                    </div>
                </div>
            )}
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/Room3D.jsx ===
import React, { Suspense } from 'react';
import { Canvas } from '@react-three/fiber';
import { OrbitControls, ContactShadows } from '@react-three/drei';
import PetPlayer from './PetPlayer';

export default function Room3D({ url, position, rotation, scale, posY = -3.0, loop = true, onInteract, hideShadow = false }) {
    const finalPos = position || [0, posY, 0];
    const finalRot = rotation || [0, 0, 0];

    const finalScale = scale || 2.2; 

    return (
        <div style={{ width: '100%', height: '100%', position: 'absolute', top: 0, left: 0, zIndex: 5 }}>
            <Canvas camera={{ position: [0, 1, 5], fov: 50 }}>
                <ambientLight intensity={0.6} />
                <directionalLight position={[5, 5, 5]} intensity={1.5} />
                <directionalLight position={[-5, 5, -5]} intensity={0.5} />

                <Suspense fallback={null}>
                    <PetPlayer 
                        key={url} 
                        url={url} 
                        position={finalPos} 
                        rotation={finalRot} 
                        scale={finalScale}
                        loop={loop} 
                        onInteract={onInteract} 
                    />
                </Suspense>

                {!hideShadow && (
                    <ContactShadows position={[0, -3.0, 0]} opacity={0.4} scale={5} blur={2} />
                )}
                
                <OrbitControls enableRotate={false} target={[0, 0, 0]} enableZoom={false} enablePan={false} minPolarAngle={Math.PI / 2.5} maxPolarAngle={Math.PI / 2} />
            </Canvas>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/SharedUI.jsx ===
import React from 'react';
import { useProgress } from '@react-three/drei';

export function LoadingScreen({ l }) {
    const { active, progress } = useProgress();
    if (!active) return null;
    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100vw', height: '100vh', background: '#2c3e50', zIndex: 9999, display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center', color: 'white' }}>
            <h2>{l.loading}</h2>
            <div style={{ width: '60%', height: '20px', background: 'rgba(0,0,0,0.3)', borderRadius: '10px', overflow: 'hidden', marginTop: '20px' }}>
                <div style={{ width: `${progress}%`, height: '100%', background: '#3498db', transition: 'width 0.3s ease' }} />
            </div>
        </div>
    );
}

export function WeatherOverlay({ weather }) {
    if (weather === 'clr') return null;
    const isRain = weather === 'rn';
    const overlayColor = isRain ? 'rgba(0, 30, 80, 0.3)' : 'rgba(255, 255, 255, 0.2)';
    const symbol = isRain ? 'üíß' : '‚ùÑÔ∏è';
    const particles = Array.from({ length: 25 }).map((_, i) => ({
        id: i, left: `${Math.random() * 100}%`, animDuration: `${isRain ? 0.7 + Math.random() * 0.5 : 3 + Math.random() * 3}s`,
        animDelay: `${Math.random() * 2}s`, opacity: 0.4 + Math.random() * 0.5, fontSize: `${isRain ? 12 + Math.random() * 10 : 16 + Math.random() * 15}px`
    }));
    return (
        <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: overlayColor, pointerEvents: 'none', zIndex: 50, overflow: 'hidden' }}>
            {particles.map(p => <div key={p.id} style={{ position: 'absolute', top: '-10%', left: p.left, opacity: p.opacity, fontSize: p.fontSize, animation: `fall ${p.animDuration} linear infinite`, animationDelay: p.animDelay }}>{symbol}</div>)}
        </div>
    );
}

export function NavButton({ icon, label, isActive, onClick, colors }) {
    return (
        <button onClick={onClick} style={{ background: isActive ? colors.border : 'transparent', border: 'none', color: colors.text, display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '5px', padding: '8px 15px', borderRadius: '15px', cursor: 'pointer', transition: 'all 0.3s ease' }}>
            <span style={{ fontSize: '24px', textShadow: colors.textShadow }}>{icon}</span>
            <span style={{ fontSize: '12px', fontWeight: 'bold', textShadow: colors.textShadow }}>{label}</span>
        </button>
    );
}

export function StatBar({ icon, value, color, onClick, isInteractive }) {
    const safeValue = Math.max(0, Math.min(100, value));
    return (
        <div 
            style={{ 
                display: 'flex', alignItems: 'center', gap: '4px', 
                fontSize: '14px', fontWeight: 'bold', 
                cursor: isInteractive ? 'pointer' : 'default',
                color: color, // –ö—Ä–∞—Å–∏–º —Ç–µ–∫—Å—Ç –≤ —Ü–≤–µ—Ç —Å—Ç–∞—Ç—ã –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã
                background: 'rgba(0,0,0,0.2)', // –õ–µ–≥–∫–∞—è –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω–∞—è –ø–æ–¥–ª–æ–∂–∫–∞
                padding: '4px 8px', borderRadius: '12px'
            }} 
            onClick={isInteractive ? onClick : undefined}
        >
            <span style={{ fontSize: '16px' }}>{icon}</span>
            <span>{safeValue}%</span>
        </div>
    );
}

export function ToggleSwitch({ isOn, onToggle, iconOn, iconOff, isDark }) {
    return (
        <div onClick={onToggle} style={{ width: '60px', height: '30px', background: isOn ? 'rgba(46, 204, 113, 0.7)' : (isDark ? 'rgba(0,0,0,0.5)' : 'rgba(0,0,0,0.1)'), borderRadius: '15px', position: 'relative', cursor: 'pointer', border: `1px solid ${isDark ? 'rgba(255,255,255,0.2)' : 'rgba(0,0,0,0.1)'}`, transition: 'background 0.3s' }}>
            <div style={{ position: 'absolute', top: '2px', left: isOn ? '32px' : '2px', width: '24px', height: '24px', background: 'white', borderRadius: '50%', transition: 'left 0.3s ease', display: 'flex', justifyContent: 'center', alignItems: 'center', fontSize: '10px', color: '#333', fontWeight: 'bold', boxShadow: '0 2px 5px rgba(0,0,0,0.2)' }}>
                {isOn ? iconOn : iconOff}
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/Tutorial.jsx ===
import React, { useEffect, useState } from 'react';

export default function Tutorial({ tutStep, text }) {
    const [ps, setPs] = useState({ t: 0, lf: 0, s: false, tx: '' });

    useEffect(() => {
        let tId = '';
        let txt = '';
        let oY = -60;
        
        switch (tutStep) {
            case 1: tId = 'btn-pl'; txt = text.t1; break;
            case 2: tId = 'btn-hm'; txt = text.t2; break;
            case 3: tId = 'btn-slp'; txt = text.t3; break;
            case 4: tId = 'btn-wrd'; txt = text.t4; break;
            case 5: tId = 'cst-snt'; txt = text.t5; oY = -40; break;
            default: return;
        }

        const tmr = setTimeout(() => {
            const el = document.getElementById(tId);
            if (el) {
                const rct = el.getBoundingClientRect();
                setPs({ 
                    s: true, 
                    lf: rct.left + rct.width / 2, 
                    t: rct.top + oY, 
                    tx: txt 
                });
            }
        }, 100);

        return () => clearTimeout(tmr);
    }, [tutStep, text]);

    if (!ps.s) return <div id="t-ovl" className="actv"></div>;
    
    return (
        <div id="t-ovl" className="actv">
            <div id="t-ptr" style={{ left: ps.lf - 25, top: ps.t }}>üëá</div>
            <div id="t-msg" style={{ left: ps.lf - 125, top: ps.t - 60 }}>{ps.tx}</div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/MainScreen.jsx ===
import React, { useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';
import { Canvas } from '@react-three/fiber';
import { useGLTF, useAnimations, OrbitControls, ContactShadows } from '@react-three/drei';
import * as THREE from 'three';
import * as SkeletonUtils from 'three/addons/utils/SkeletonUtils.js';

// –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
useGLTF.preload('/models/idle.glb');
useGLTF.preload('/models/sleep.glb');
useGLTF.preload('/models/joy_jump.glb');
useGLTF.preload('/models/hello.glb');
useGLTF.preload('/models/fall.glb');
useGLTF.preload('/models/sick.glb');
useGLTF.preload('/models/eat.glb');

function PetModel({ url, loop = true, posY = -3.0, onInteract }) {
    // –î–æ–±–∞–≤–∏–ª–∏ ref –¥–ª—è –≥—Ä—É–ø–ø—ã, —á—Ç–æ–±—ã –∞–Ω–∏–º–∞—Ü–∏–∏ –∑–Ω–∞–ª–∏, –≥–¥–µ –∏—Å–∫–∞—Ç—å –∫–æ—Å—Ç–∏
    const group = useRef();
    const { scene, animations } = useGLTF(url);
    
    // üî• –ú–ê–ì–ò–Ø –ó–î–ï–°–¨: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ —Å–∫–µ–ª–µ—Ç–æ–º!
    const clonedScene = useMemo(() => SkeletonUtils.clone(scene), [scene]);
    
    // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ –∫ –Ω–∞—à–µ–π –≥—Ä—É–ø–ø–µ
    const { actions, mixer } = useAnimations(animations, group);

    useLayoutEffect(() => {
        // –ù–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±: –±–µ—Ä–µ–º —Å–∞–º—É—é –ø–µ—Ä–≤—É—é –∞–Ω–∏–º–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞ (–∫–∞–∫ –¥–µ–ª–∞–µ—Ç —Ç–≤–æ–π —Ç–∏–º–º–µ–π—Ç)
        if (!animations || animations.length === 0) return;
        
        const clipName = animations[0].name;
        const action = actions[clipName];

        if (action) {
            action.reset();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏—è
            if (!loop) {
                action.setLoop(THREE.LoopOnce, 1);
                action.clampWhenFinished = true; // –ó–∞–º–µ—Ä–µ—Ç—å –≤ –∫–æ–Ω—Ü–µ (–¥–ª—è –ø–∞–¥–µ–Ω–∏—è)
            } else {
                action.setLoop(THREE.LoopRepeat, Infinity);
            }
            
            action.play();
            
            // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º –ø–æ–∑—É –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä –Ω–∞—Ä–∏—Å—É–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É
            mixer.update(0);
        }

        return () => {
            if (action) action.stop();
        };
    }, [url, actions, mixer, loop, animations]);

    return (
        <group ref={group} dispose={null} onClick={onInteract}>
            <primitive object={clonedScene} position={[0, posY, 0]} rotation={[0, 0, 0]} scale={2.2} />
        </group>
    );
}

// === –í–ï–°–¨ –û–°–¢–ê–õ–¨–ù–û–ô –ö–û–î –û–°–¢–ê–ï–¢–°–Ø –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ===
export default function MainScreen({ currentView, stats, isEating, isGreeting }) {
    const [isPetting, setIsPetting] = useState(false);

    // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è: —Ç–µ–ø–µ—Ä—å –º—ã –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ü–£–¢–¨ –ö –§–ê–ô–õ–£ (url)
    const getAnimationState = () => {
        if (isGreeting) return { url: '/models/hello.glb', loop: false, posY: -3.0 };

        let criticalCount = 0;
        if (stats?.hunger <= 15) criticalCount++;
        if (stats?.energy <= 15) criticalCount++;
        if (stats?.mood <= 15) criticalCount++;

        if (currentView !== 'wardrobe' && currentView !== 'sleep') {
            if (criticalCount >= 2) return { url: '/models/fall.glb', loop: false, posY: -3.0 };
            if (criticalCount === 1) return { url: '/models/sick.glb', loop: true, posY: -3.0 };
        }

        switch (currentView) {
            case 'sleep': return { url: '/models/sleep.glb', loop: true, posY: -1.8 };
            case 'wardrobe': return { url: '/models/idle.glb', loop: true, posY: -3.0 };
            case 'play': return { url: isPetting ? '/models/joy_jump.glb' : '/models/idle.glb', loop: true, posY: -3.0 };
            case 'home': return { url: isEating ? '/models/eat.glb' : '/models/idle.glb', loop: true, posY: -3.0 };
            default: return { url: '/models/idle.glb', loop: true, posY: -3.0 };
        }
    };

    const animState = getAnimationState();

    const handleInteract = (e) => {
        e.stopPropagation();
        if (currentView === 'play' && animState.url !== '/models/fall.glb') {
            setIsPetting(true);
            setTimeout(() => setIsPetting(false), 2000);
        }
    };

    return (
        <div style={{ width: '100%', height: '100%', position: 'absolute', top: 0, left: 0, zIndex: 5 }}>
            <Canvas camera={{ position: [0, 1, 5], fov: 50 }}>
                <ambientLight intensity={0.6} />
                <directionalLight position={[5, 5, 5]} intensity={1.5} />
                <directionalLight position={[-5, 5, -5]} intensity={0.5} />

                <PetModel url={animState.url} loop={animState.loop} posY={animState.posY} onInteract={handleInteract} />

                {currentView !== 'sleep' && (
                    <ContactShadows position={[0, -3.0, 0]} opacity={0.4} scale={5} blur={2} />
                )}
                
                <OrbitControls target={[0, 0, 0]} enableZoom={false} enablePan={false} minPolarAngle={Math.PI / 2.5} maxPolarAngle={Math.PI / 2} />
            </Canvas>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/Modal.jsx ===
import React from 'react';

export default function Modal({ isOpen, title, onClose, children }) {
    return (
        <div className={`modal ${isOpen ? 'open' : ''}`}>
            <div className="modal-header">
                <h3>{title}</h3>
                <button className="close-btn" onClick={onClose}>‚úñ</button>
            </div>
            <div className="modal-content">
                {children}
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./components/StatsOverlay.jsx ===
import React from 'react';

export default function StatsOverlay({ stats, text }) {
    return (
        <div className="st-ovl vis">
            <div className="st-grp">
                <div className="st-hdr">
                    <span>üçó {text.hng}</span>
                    <span>{Math.round(stats.hunger)}%</span>
                </div>
                <div className="st-bar">
                    <div className="st-fl f-hng" style={{ width: `${stats.hunger}%` }}></div>
                </div>
            </div>

            <div className="st-grp">
                <div className="st-hdr">
                    <span>‚ö° {text.eng}</span>
                    <span>{Math.round(stats.energy)}%</span>
                </div>
                <div className="st-bar">
                    <div className="st-fl f-eng" style={{ width: `${stats.energy}%` }}></div>
                </div>
            </div>

            <div className="st-grp">
                <div className="st-hdr">
                    <span>üíñ {text.md}</span>
                    <span>{Math.round(stats.mood)}%</span>
                </div>
                <div className="st-bar">
                    <div className="st-fl f-md" style={{ width: `${stats.mood}%` }}></div>
                </div>
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./classes/PetRenderer.js ===
export default class PRnd {
    constructor(cvs) {
        this.ctx = cvs.getContext('2d');
        this.tm = 0; this.st = 'brd'; this.cst = 'none'; this.chr = 'pig'; this.aId = null;
    }
    upd(st, cst, chr) { this.st = st; this.cst = cst; this.chr = chr; }
    srt() {
        const drw = () => {
            const c = this.ctx;
            c.clearRect(0, 0, 300, 300); this.tm += 0.05;
            c.shadowColor = 'rgba(0,0,0,0.15)'; c.shadowBlur = 10; c.shadowOffsetY = 5;

            let bY = 180 + Math.sin(this.tm)*2, hY = 120 + Math.sin(this.tm)*3;
            if (this.st === 'brd') hY += 10;
            else if (this.st === 'play') { bY -= Math.abs(Math.sin(this.tm*3)*15); hY = bY - 60; }

            // 1. –°–í–ò–ù–ö–ê
            if (this.chr === 'pig') {
                c.fillStyle = '#f5a4b5'; c.beginPath(); c.ellipse(150, bY, 45, 55, 0, 0, 2*Math.PI); c.fill(); 
                c.fillStyle = '#e08b9c'; c.beginPath(); c.ellipse(130, bY+50, 15, 20, 0, 0, 2*Math.PI); c.fill(); c.beginPath(); c.ellipse(170, bY+50, 15, 20, 0, 0, 2*Math.PI); c.fill(); 
                c.beginPath(); 
                if (this.st === 'brd') { c.ellipse(100, bY+10, 12, 35, 0.3, 0, 2*Math.PI); c.fill(); c.beginPath(); c.ellipse(200, bY+10, 12, 35, -0.3, 0, 2*Math.PI); c.fill(); }
                else if (this.st === 'play') { c.ellipse(90, bY-20, 12, 35, -0.8, 0, 2*Math.PI); c.fill(); c.beginPath(); c.ellipse(210, bY-20, 12, 35, 0.8, 0, 2*Math.PI); c.fill(); }
                else { c.ellipse(100, bY, 12, 30, 0.5, 0, 2*Math.PI); c.fill(); c.beginPath(); c.ellipse(200, bY, 12, 30, -0.5, 0, 2*Math.PI); c.fill(); }
                c.fillStyle = '#f28b9c'; c.beginPath(); c.ellipse(150, hY, 55, 50, 0, 0, 2*Math.PI); c.fill(); 
                c.fillStyle = '#e06b6b'; c.beginPath(); c.ellipse(150, hY+10, 18, 12, 0, 0, 2*Math.PI); c.fill(); 
                c.fillStyle = '#4a2a2a'; c.beginPath(); c.arc(143, hY+10, 3, 0, 2*Math.PI); c.fill(); c.beginPath(); c.arc(157, hY+10, 3, 0, 2*Math.PI); c.fill();
                c.fillStyle = '#fff'; c.beginPath(); c.arc(125, hY-10, 12, 0, 2*Math.PI); c.fill(); c.beginPath(); c.arc(175, hY-10, 12, 0, 2*Math.PI); c.fill(); 
                c.fillStyle = '#2d1e1e';
                if (this.st === 'brd') { c.beginPath(); c.arc(125, hY-10, 6, 0, 2*Math.PI); c.fill(); c.beginPath(); c.arc(175, hY-10, 6, 0, 2*Math.PI); c.fill(); c.fillStyle='#f28b9c'; c.fillRect(110, hY-25, 30, 15); c.fillRect(160, hY-25, 30, 15); }
                else if (this.st === 'slp') { c.fillRect(115, hY-10, 20, 4); c.fillRect(165, hY-10, 20, 4); }
                else { c.beginPath(); c.arc(125, hY-10, 6, 0, 2*Math.PI); c.fill(); c.beginPath(); c.arc(175, hY-10, 6, 0, 2*Math.PI); c.fill(); }
            } 
            // 2. –ü–£–•–õ–Ø–®
            else if (this.chr === 'fluffy') {
                c.fillStyle = '#ffd8b0'; c.beginPath(); c.ellipse(150, hY+20, 70, 75, 0, 0, 2*Math.PI); c.fill();
                c.fillStyle = '#f0b892'; c.save(); c.translate(95, hY-10); c.rotate(-0.2 + Math.sin(this.tm)*0.1); c.beginPath(); c.ellipse(0, 0, 15, 35, 0, 0, 2*Math.PI); c.fill(); c.restore();
                c.save(); c.translate(205, hY-10); c.rotate(0.2 + Math.cos(this.tm)*0.1); c.beginPath(); c.ellipse(0, 0, 15, 35, 0, 0, 2*Math.PI); c.fill(); c.restore();
                c.fillStyle = '#fff'; c.beginPath(); c.arc(115, hY+10, 14, 0, 2*Math.PI); c.fill(); c.beginPath(); c.arc(185, hY+10, 14, 0, 2*Math.PI); c.fill();
                c.fillStyle = '#563e2c'; 
                if (this.st === 'slp') { c.fillRect(105, hY+10, 20, 4); c.fillRect(175, hY+10, 20, 4); }
                else { c.beginPath(); c.arc(115, hY+10, 7, 0, 2*Math.PI); c.fill(); c.beginPath(); c.arc(185, hY+10, 7, 0, 2*Math.PI); c.fill(); }
                c.strokeStyle = '#b14b4b'; c.lineWidth = 4; c.beginPath(); c.arc(150, hY+40, 20, 0.1, Math.PI-0.1); c.stroke();
            }
            // 3. –ì–õ–ê–ó–ê–°–¢–ò–ö
            else if (this.chr === 'eye') {
                const g = c.createRadialGradient(120, hY, 20, 150, hY, 100); g.addColorStop(0, '#9fd9d9'); g.addColorStop(0.6, '#349b9b');
                c.fillStyle = g; c.beginPath(); c.ellipse(150, hY+30, 80, 85, 0, 0, Math.PI*2); c.fill();
                c.fillStyle = '#fff'; c.beginPath(); c.ellipse(150, hY+10, 35, 38, 0, 0, 2*Math.PI); c.fill();
                c.fillStyle = '#1a2f3f'; 
                if (this.st === 'slp') { c.fillRect(115, hY+10, 70, 5); }
                else { c.beginPath(); c.arc(150 + Math.sin(this.tm*2)*10, hY+10, 18, 0, 2*Math.PI); c.fill(); }
            }

            // –®–ê–ü–ö–ê –î–õ–Ø –í–°–ï–•
            if (this.cst === 'snt') { 
                let sY = (this.chr === 'eye') ? hY - 30 : (this.chr === 'fluffy') ? hY - 35 : hY - 25;
                c.fillStyle = '#e63946'; c.beginPath(); c.moveTo(110, sY); c.lineTo(150, sY-60); c.lineTo(190, sY); c.fill();
                c.fillStyle = '#fff'; c.beginPath(); c.ellipse(150, sY, 45, 9, 0, 0, 2*Math.PI); c.fill(); 
                c.beginPath(); c.arc(150, sY-60, 12, 0, 2*Math.PI); c.fill(); 
            }
            this.aId = requestAnimationFrame(drw);
        }; drw();
    }
    stp() { if (this.aId) cancelAnimationFrame(this.aId); }
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./assets/react.svg ===
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/SettingsView.jsx ===
import React from 'react';

export default function SettingsView({ text, theme, setTheme, lang, setLang, city, setCity, fetchWeather }) {
    return (
        <div className="v-scrn">
            <div className="m-hdr"><h3>{text.stg}</h3></div>
            <div className="m-cnt" style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>
                <div className="s-row">
                    <span>{text.th_t}</span>
                    <label className="swch"><input type="checkbox" checked={theme === 'drk'} onChange={() => setTheme(theme === 'lgt' ? 'drk' : 'lgt')} /><span className="swch-sld"></span></label>
                </div>
                <div className="s-row">
                    <span>{text.ln_t}</span>
                    <label className="swch"><input type="checkbox" checked={lang === 'en'} onChange={() => setLang(lang === 'ru' ? 'en' : 'ru')} /><span className="swch-sld"></span></label>
                </div>
                <div className="s-row" style={{ flexDirection: 'column', alignItems: 'flex-start' }}>
                    <span>{text.cty}</span><input className="c-inp" value={city} onChange={e => setCity(e.target.value)} onBlur={fetchWeather} />
                </div>
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/PlayView.jsx ===
import React, { useState } from 'react';
import Room3D from '../components/Room3D';

export default function PlayView({ character = 'twilight', stats, setStats, sendAction, isGreeting, onPet }) {
    const [action, setAction] = useState('idle');

    let criticalCount = 0;
    if (stats?.hng <= 15) criticalCount++;
    if (stats?.eng <= 15) criticalCount++;
    if (stats?.md <= 15) criticalCount++;

    let currentAnim = action;
    if (isGreeting) currentAnim = 'hello';
    else if (criticalCount >= 2) currentAnim = 'fall';
    else if (criticalCount === 1 && action !== 'joy_jump') currentAnim = 'sick';

    const handleInteract = (e) => {
        e.stopPropagation();
        if (currentAnim !== 'fall' && currentAnim !== 'joy_jump') {
            setAction('joy_jump');
            setStats(prev => ({ ...prev, md: Math.min(100, prev.md + 15), eng: Math.max(0, prev.eng - 5) }));
            sendAction('pl');

            // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–ª–ª–±—ç–∫ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è
            if (onPet) onPet();

            setTimeout(() => setAction('idle'), 2000);
        }
    };

    const scaleMult = character === 'rick' ? 0.2 : 1;

    return (
        <div style={{ 
            width: '100vw', height: '100vh', position: 'relative', overflow: 'hidden',
            backgroundImage: 'url(/images/street_bg.png)',
            backgroundSize: 'cover', backgroundPosition: 'center', backgroundRepeat: 'no-repeat',
        }}>
            <Room3D 
                url={`/models/${character}/${currentAnim}.glb`} 
                posY={-3.0} 
                scale={2.2 * scaleMult} 
                loop={currentAnim !== 'fall' && currentAnim !== 'hello'} 
                onInteract={handleInteract} 
            />
            
            <div style={{ position: 'absolute', bottom: '15%', width: '100%', textAlign: 'center', pointerEvents: 'none', zIndex: 10 }}>
                <span style={{ backgroundColor: 'rgba(255,255,255,0.8)', padding: '10px 20px', borderRadius: '25px', fontWeight: 'bold' }}>
                    üëÜ –ü–æ–≥–ª–∞–¥—å –º–µ–Ω—è!
                </span>
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/WardrobeView.jsx ===
import React from 'react';
import Room3D from '../components/Room3D';

export default function WardrobeView({ character = 'twilight' }) {
    const modelUrl = `/models/${character}/idle.glb`;

    return (
        <div style={{ 
            width: '100vw', height: '100vh', position: 'relative', overflow: 'hidden',
            backgroundImage: 'url(/images/dressroom_bg.png)',
            backgroundSize: 'cover', backgroundPosition: 'center', backgroundRepeat: 'no-repeat',
        }}>
            
            <Room3D 
                url={modelUrl} 
                posY={-3.0}
                scale={2.2}
                loop={true} 
            />

            <div style={{ position: 'absolute', top: '10%', width: '100%', textAlign: 'center', pointerEvents: 'none', zIndex: 10 }}>
                <span style={{ backgroundColor: '#fff', color: '#8ca6db', padding: '8px 20px', borderRadius: '20px', fontWeight: 'bold', boxShadow: '0 4px 10px rgba(0,0,0,0.1)' }}>
                    ‚ú® –ì–∞—Ä–¥–µ—Ä–æ–±
                </span>
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/ToiletView.jsx ===
import React from 'react';
import Room3D from '../components/Room3D';

export default function ToiletView({ character = 'twilight' }) {
    // –í App.jsx –º—ã —É–∂–µ –¥–æ–±–∞–≤–∏–ª–∏ –≤ ANIMATIONS_LIST –∞–Ω–∏–º–∞—Ü–∏—é 'toilet'
    // –¢–≤–æ–µ–º—É —Ç–∏–º–º–µ–π—Ç—É –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é —Å–∏–¥–µ–Ω–∏—è –∏ –Ω–∞–∑–≤–∞—Ç—å –µ—ë toilet.glb
    const modelUrl = `/models/${character}/toilet.glb`;
    const scaleMult = character === 'rick' ? 0.2 : 1;
    return (
        <div style={{ 
            width: '100vw', height: '100vh', position: 'relative', overflow: 'hidden', 
            backgroundImage: 'url(/images/toilet_bg.png)', // –§–æ–Ω –≤–∞–Ω–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã
            backgroundSize: 'cover', backgroundPosition: 'center' 
        }}>
            
            {/* 3D –ü–∏—Ç–æ–º–µ—Ü (–ù–∞—Ö–æ–¥–∏—Ç—Å—è –ó–ê –¥–≤–µ—Ä—å—é) */}
            <Room3D 
                url={modelUrl} 
                posY={-2.5} 
                scale={2.2 * scaleMult} 
                loop={true} 
            />

            {/* –í–ï–ö–¢–û–†–ù–ê–Ø –î–í–ï–†–¨ –ö–ê–ë–ò–ù–ö–ò */}
            <div style={{
                position: 'absolute',
                bottom: '12%', // –ó–∞–∑–æ—Ä —Å–Ω–∏–∑—É, —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ –Ω–æ–≥–∏!
                left: '50%',
                transform: 'translateX(-50%)',
                width: '65%',
                height: '65%',
                background: 'linear-gradient(180deg, #ecf0f1 0%, #bdc3c7 100%)', // –¶–≤–µ—Ç –¥–≤–µ—Ä–∏
                border: '6px solid #7f8c8d',
                borderRadius: '5px',
                zIndex: 10,
                boxShadow: '10px 10px 20px rgba(0,0,0,0.4), inset 0 0 20px rgba(255,255,255,0.5)',
                display: 'flex',
                flexDirection: 'column',
                alignItems: 'center'
            }}>
                {/* –¢–µ–Ω—å –ø–æ–¥ –¥–≤–µ—Ä—å—é (–ø–∞–¥–∞–µ—Ç –Ω–∞ –Ω–æ–≥–∏) */}
                <div style={{ position: 'absolute', bottom: '-20px', left: 0, width: '100%', height: '20px', background: 'linear-gradient(180deg, rgba(0,0,0,0.5) 0%, transparent 100%)' }} />

                {/* –¢–∞–±–ª–∏—á–∫–∞ WC */}
                <div style={{ 
                    marginTop: '30px', padding: '10px 20px', 
                    background: '#34495e', color: '#ecf0f1', 
                    borderRadius: '8px', fontWeight: 'bold', fontSize: '24px',
                    boxShadow: '0 4px 6px rgba(0,0,0,0.3)',
                    border: '2px solid #2c3e50'
                }}>
                    WC
                </div>

                {/* –†—É—á–∫–∞ –¥–≤–µ—Ä–∏ (–ó–∞–Ω—è—Ç–æ - –∫—Ä–∞—Å–Ω—ã–π) */}
                <div style={{ 
                    position: 'absolute', right: '15px', top: '50%', 
                    width: '12px', height: '40px', background: '#c0392b', 
                    borderRadius: '6px', border: '2px solid #922b21',
                    boxShadow: '2px 2px 5px rgba(0,0,0,0.3)'
                }} />
                
                {/* –ü–µ—Ç–ª–∏ */}
                <div style={{ position: 'absolute', left: '-6px', top: '20%', width: '6px', height: '30px', background: '#7f8c8d', borderRadius: '3px 0 0 3px' }} />
                <div style={{ position: 'absolute', left: '-6px', bottom: '20%', width: '6px', height: '30px', background: '#7f8c8d', borderRadius: '3px 0 0 3px' }} />
            </div>

            {/* –ü–æ–ª—É–º—Ä–∞–∫ –¥–ª—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã */}
            <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', backgroundColor: 'rgba(20, 30, 40, 0.2)', pointerEvents: 'none', zIndex: 11 }} />
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/SleepView.jsx ===
import React, { useEffect } from 'react';
import Room3D from '../components/Room3D';

export default function SleepView({ character = 'twilight', stats, setStats, sendAction }) {
    const modelUrl = `/models/${character}/sleep.glb`;

    useEffect(() => {
        sendAction('slp');

        return () => {
            sendAction('idle');
        };
    }, []); 
    const scaleMult = character === 'rick' ? 0.2 : 1;

    return (
        <div style={{ width: '100vw', height: '100vh', position: 'relative', overflow: 'hidden', backgroundImage: 'url(/images/sleeproom_bg.png)', backgroundSize: 'cover', backgroundPosition: 'center' }}>
            <Room3D url={modelUrl} position={[0, 0.5, 0]} rotation={[Math.PI / 2, 10, 0]} scale={1.5 * scaleMult} loop={true} hideShadow={true} />
            <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', backgroundColor: 'rgba(10, 15, 30, 0.6)', pointerEvents: 'none', zIndex: 10 }} />
            <div style={{ position: 'absolute', top: '20%', right: '25%', fontSize: '30px', color: '#fff', opacity: 0.8, zIndex: 11, animation: 'float 3s ease-in-out infinite' }}>ZzZ...</div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/DevView.jsx ===
import React, { useState } from 'react';
import Room3D from '../components/Room3D';

const ALL_ANIMATIONS = ['idle', 'sleep', 'joy_jump', 'hello', 'fall', 'sick', 'eat'];

export default function DevView({ character = 'twilight' }) {
    const [activeAnim, setActiveAnim] = useState('idle');
    const scaleMult = character === 'rick' ? 0.2 : 1;
    return (
        <div style={{ width: '100%', height: '100vh', background: '#261738', position: 'relative' }}>
            <Room3D 
                url={`/models/${character}/${activeAnim}.glb`} 
                posY={-3.0} 
                scale={2.2 * scaleMult}
                loop={activeAnim !== 'fall' && activeAnim !== 'hello'} 
            />

            <div style={{
                position: 'absolute', top: '10%', left: '5%', right: '5%',
                background: 'rgba(0,0,0,0.7)', padding: '15px', borderRadius: '15px',
                zIndex: 10, display: 'flex', flexWrap: 'wrap', gap: '10px', justifyContent: 'center'
            }}>
                <h3 style={{ width: '100%', textAlign: 'center', color: 'white', margin: '0 0 10px 0' }}>
                    üõ† DEV MODE: –¢–µ—Å—Ç –∞–Ω–∏–º–∞—Ü–∏–π
                </h3>
                {ALL_ANIMATIONS.map(anim => (
                    <button 
                        key={anim}
                        onClick={() => setActiveAnim(anim)}
                        style={{
                            padding: '8px 12px', borderRadius: '8px', border: 'none',
                            background: activeAnim === anim ? '#3498db' : '#555',
                            color: 'white', fontWeight: 'bold', cursor: 'pointer'
                        }}
                    >
                        {anim}
                    </button>
                ))}
            </div>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/SlotsView.jsx ===
import React, { useState } from 'react';

// –ù–æ–≤—ã–µ –≤–µ—Å–∞ –¥–ª—è –¥–µ–Ω–µ–≥ (–°—É–º–º–∞ = 100%)
// payout - —ç—Ç–æ —Å–∫–æ–ª—å–∫–æ –º–æ–Ω–µ—Ç –º—ã –í–´–ò–ì–†–´–í–ê–ï–ú
const RARITIES = [
    { id: 'nothing', name: '–ü—É—Å—Ç–æ...', color: '#7f8c8d', icon: '‚ùå', chance: 0, payout: 0 },
    { id: 'small', name: '–ì–æ—Ä—Å—Ç—å –º–æ–Ω–µ—Ç', color: '#bdc3c7', icon: 'ü™ô', chance: 0, payout: 75 },
    { id: 'medium', name: '–ö–æ—à–µ–ª–µ–∫', color: '#3498db', icon: 'üí∞', chance: 0, payout: 200 },
    { id: 'epic', name: '–ú–µ—à–æ–∫ –∑–æ–ª–æ—Ç–∞', color: '#9b59b6', icon: 'üõçÔ∏è', chance: 0, payout: 500 },
    { id: 'jackpot', name: '–î–ñ–ï–ö–ü–û–¢!', color: '#f1c40f', icon: 'üíé', chance: 100, payout: 2500 }
];

const PLAYABLE_ICONS = ['ü™ô', 'üí∞', 'üõçÔ∏è', 'üíé', 'üçí', 'üîî', 'üçÄ', 'üçì', '7Ô∏è‚É£'];

// –¢–µ–ø–µ—Ä—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç balance –∏ sendAction –∏–∑ App.jsx
export default function SlotsView({ balance, setBalance, sendAction }) {
    const SPIN_COST = 50;

    const [isSpinning, setIsSpinning] = useState(false);
    const [resultIcons, setResultIcons] = useState(['üé∞', 'üé∞', 'üé∞']); 
    const [strips, setStrips] = useState([[], [], []]);
    const [result, setResult] = useState(null);
    const [showCoinRain, setShowCoinRain] = useState(false);
    
    // –ù–æ–≤—ã–µ —Å—Ç–µ–π—Ç—ã –¥–ª—è –¢–£–†–ë–û-–∞–Ω–∏–º–∞—Ü–∏–∏ –¥–∂–µ–∫–ø–æ—Ç–∞
    const [shakeOn, setShakeOn] = useState(false);
    const [jackpotParticles, setJackpotParticles] = useState(false);
    const [coinSpew, setCoinSpew] = useState(false);

    const getWinRarity = () => {
        const roll = Math.random() * 100;
        let currentSum = 0;
        for (const rarity of RARITIES) {
            currentSum += rarity.chance;
            if (roll <= currentSum) return rarity;
        }
        return RARITIES[0];
    };

    const handleSpin = () => {
        if (balance < SPIN_COST || isSpinning) return;

        // –°–ø–∏—Å—ã–≤–∞–µ–º –ø–ª–∞—Ç—É –∑–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫—É
        setBalance(prev => prev - SPIN_COST);
        sendAction('balance_add', `-${SPIN_COST}`);
        
        setIsSpinning(true);
        setResult(null);
        setShowCoinRain(false);
        setShakeOn(false);
        setJackpotParticles(false);
        setCoinSpew(false);

        const win = getWinRarity();

        let targetIcons;
        if (win.id === 'nothing') {
            const shuffled = [...PLAYABLE_ICONS].sort(() => 0.5 - Math.random());
            targetIcons = [shuffled[0], shuffled[1], shuffled[2]];
        } else {
            targetIcons = [win.icon, win.icon, win.icon];
        }

        const REEL_LENGTH = 30;
        const newStrips = [0, 1, 2].map(reelIdx => {
            const strip = [resultIcons[reelIdx]];
            for (let i = 1; i < REEL_LENGTH - 1; i++) {
                strip.push(PLAYABLE_ICONS[Math.floor(Math.random() * PLAYABLE_ICONS.length)]);
            }
            strip.push(targetIcons[reelIdx]);
            return strip;
        });

        setStrips(newStrips);

        setTimeout(() => {
            setIsSpinning(false);
            setResultIcons(targetIcons);
            setResult(win);
            
            // –ï—Å–ª–∏ –≤—ã–∏–≥—Ä–∞–ª–∏, –Ω–∞—á–∏—Å–ª—è–µ–º –ø—Ä–∏–∑!
            if (win.payout > 0) {
                setBalance(prev => prev + win.payout);
                sendAction('balance_add', win.payout.toString());
                
                // –í–∫–ª—é—á–∞–µ–º –¢–£–†–ë–û-–∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è –î–ñ–ï–ö–ü–û–¢–ê
                if (win.id === 'jackpot') {
                    setShakeOn(true);
                    setJackpotParticles(true);
                    setCoinSpew(true);
                    
                    // –í—ã–∫–ª—é—á–∞–µ–º —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        setShakeOn(false);
                        setJackpotParticles(false);
                        setCoinSpew(false);
                    }, 4000);
                } else if (win.payout >= 200) {
                    // –û–±—ã—á–Ω—ã–π –¥–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –≤—ã–∏–≥—Ä—ã—à–µ–π
                    setShowCoinRain(true);
                    setTimeout(() => setShowCoinRain(false), 4000);
                }
            }
        }, 3000); 
    };

    return (
        <div style={{ width: '100vw', height: '100vh', background: 'radial-gradient(circle, #2c3e50 0%, #0f171e 100%)', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', color: 'white', fontFamily: 'sans-serif', overflow: 'hidden', position: 'relative' }}>
            
            {/* –î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç –ø—Ä–∏ –∫—Ä—É–ø–Ω–æ–º –≤—ã–∏–≥—Ä—ã—à–µ (–Ω–µ –¥–∂–µ–∫–ø–æ—Ç) */}
            {showCoinRain && (
                <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', pointerEvents: 'none', zIndex: 10 }}>
                    {Array.from({ length: 25 }).map((_, i) => (
                        <div key={i} style={{ position: 'absolute', left: `${Math.random() * 100}%`, top: `-10%`, fontSize: `${Math.random() * 10 + 20}px`, animation: `coinFall ${Math.random() * 2 + 2}s linear forwards` }}>
                            {['üí∞', 'ü™ô'][Math.floor(Math.random() * 2)]}
                        </div>
                    ))}
                </div>
            )}

            {/* --- –î–ñ–ï–ö–ü–û–¢ –û–í–ï–†–õ–ï–ô: –§–µ–π–µ—Ä–≤–µ—Ä–∫–∏ –∏ –≤–∑—Ä—ã–≤—ã --- */}
            {jackpotParticles && (
                <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', pointerEvents: 'none', zIndex: 100 }}>
                    {Array.from({ length: 40 }).map((_, i) => (
                        <svg key={i} viewBox="0 0 100 100" style={{ position: 'absolute', left: `${Math.random() * 80 + 10}%`, top: `${Math.random() * 50 + 10}%`, width: '150px', height: '150px', transform: 'translate(-50%, -50%)', opacity: 0, animation: `jackpotBurst 1s linear forwards`, animationDelay: `${Math.random() * 3}s` }}>
                            <circle cx="50" cy="50" r="10" fill={['#f1c40f', '#9b59b6', '#2ecc71', '#e74c3c'][Math.floor(Math.random() * 4)]} style={{ animation: `jackpotParticleExpand 0.5s ease-out` }} />
                        </svg>
                    ))}
                </div>
            )}

            {/* –î–ò–ó–ê–ô–ù –ò–ì–†–û–í–û–ì–û –ê–í–¢–û–ú–ê–¢–ê (—Å –¢–†–Ø–°–ö–û–ô) */}
            <div style={{ 
                background: 'linear-gradient(180deg, #d35400 0%, #c0392b 100%)', border: '8px solid #922b21', borderRadius: '40px 40px 20px 20px', padding: '30px', boxShadow: '0 20px 50px rgba(0,0,0,0.8), inset 0 10px 20px rgba(255,255,255,0.2)', width: '90%', maxWidth: '400px', display: 'flex', flexDirection: 'column', alignItems: 'center',
                animation: shakeOn ? 'jackpotShake 0.1s linear infinite' : 'none',
                zIndex: 10
            }}>
                
                {/* –í—ã–≤–µ—Å–∫–∞ */}
                <h1 style={{ margin: '0 0 20px 0', textShadow: '0 0 15px #f1c40f', color: '#f1c40f', fontSize: '28px', textAlign: 'center', textTransform: 'uppercase', letterSpacing: '2px' }}>
                    –î–µ–Ω–µ–∂–Ω—ã–π –°–ª–æ—Ç
                </h1>

                {/* –ú–∏–≥–∞—é—â–∏–µ –ª–∞–º–ø–æ—á–∫–∏ —Å–≤–µ—Ä—Ö—É */}
                <div style={{ display: 'flex', justifyContent: 'space-between', width: '100%', marginBottom: '15px', padding: '0 10px' }}>
                    {Array.from({ length: 6 }).map((_, i) => (
                        <div key={i} style={{ width: '15px', height: '15px', borderRadius: '50%', background: '#f1c40f', animation: `blink 0.5s infinite alternate ${i * 0.1}s`, border: '2px solid #8e44ad' }} />
                    ))}
                </div>

                {/* –≠–∫—Ä–∞–Ω —Å–ª–æ—Ç–æ–≤ (–ú–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∞—è —Ä–∞–º–∫–∞) */}
                <div style={{ background: 'linear-gradient(180deg, #7f8c8d 0%, #34495e 100%)', padding: '15px', borderRadius: '20px', border: '4px solid #2c3e50', boxShadow: 'inset 0 10px 20px rgba(0,0,0,0.5)', width: '100%' }}>
                    
                    <div style={{ display: 'flex', gap: '10px', justifyContent: 'space-between' }}>
                        {[0, 1, 2].map((idx) => (
                            <div key={idx} style={{ flex: 1, height: '100px', background: 'linear-gradient(180deg, #fdfbfb 0%, #ebedee 100%)', borderRadius: '10px', overflow: 'hidden', border: '2px solid #bdc3c7', boxShadow: 'inset 0 10px 15px rgba(0,0,0,0.2)', position: 'relative' }}>
                                
                                {/* –≠—Ñ—Ñ–µ–∫—Ç —Ç–µ–Ω–∏ –≤–Ω—É—Ç—Ä–∏ –±–∞—Ä–∞–±–∞–Ω–∞ */}
                                <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', background: 'linear-gradient(180deg, rgba(0,0,0,0.3) 0%, transparent 20%, transparent 80%, rgba(0,0,0,0.3) 100%)', zIndex: 10, pointerEvents: 'none' }} />

                                {isSpinning ? (
                                    // –ê–Ω–∏–º–∞—Ü–∏—è –∫—Ä—É—á–µ–Ω–∏—è
                                    <div style={{ animation: `spinReel ${2 + idx * 0.5}s cubic-bezier(0.15, 0.85, 0.15, 1) forwards` }}>
                                        {strips[idx].map((icon, i) => (
                                            <div key={i} style={{ height: '100px', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '50px', filter: 'blur(1px)' }}>{icon}</div>
                                        ))}
                                    </div>
                                ) : (
                                    // –°—Ç–∞—Ç–∏—á–Ω–∞—è –∏–∫–æ–Ω–∫–∞
                                    <div style={{ height: '100px', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '50px' }}>{resultIcons[idx]}</div>
                                )}
                            </div>
                        ))}
                    </div>
                </div>

                {/* –û—Ç–≤–µ—Ä—Å—Ç–∏–µ –¥–ª—è –º–æ–Ω–µ—Ç + –ß–ò–°–¢–´–ô –ì–ï–ú–ë–õ–ò–ù–ì –í–´–õ–ï–¢ –ú–û–ù–ï–¢ –ò–ó –ê–ü–ü–ê–†–ê–¢–ê */}
                <div style={{ width: '60px', height: '15px', background: '#000', border: '2px solid #7f8c8d', borderRadius: '5px', marginTop: '20px', boxShadow: 'inset 0 5px 5px rgba(0,0,0,1)', position: 'relative' }}>
                    {coinSpew && (
                        <div style={{ position: 'absolute', top: '50%', left: '50%', width: '100px', height: '100px', transform: 'translate(-50%, -50%)', zIndex: 100, pointerEvents: 'none' }}>
                            {Array.from({ length: 30 }).map((_, i) => (
                                <div key={i} style={{ position: 'absolute', top: 0, left: `${Math.random() * 40 - 20}%`, fontSize: `${Math.random() * 10 + 15}px`, animation: `jackpotCoinSpew ${Math.random() * 1.5 + 0.5}s ease-out forwards`, animationDelay: `${Math.random() * 1}s` }}>
                                    {['üí∞', 'ü™ô'][Math.floor(Math.random() * 2)]}
                                </div>
                            ))}
                        </div>
                    )}
                </div>

                {/* –ö–Ω–æ–ø–∫–∞ SPIN */}
                <button 
                    onClick={handleSpin}
                    disabled={isSpinning || balance < SPIN_COST}
                    style={{
                        marginTop: '25px', padding: '15px 40px', fontSize: '24px', fontWeight: 'bold', textTransform: 'uppercase',
                        background: isSpinning ? '#95a5a6' : (balance >= SPIN_COST ? 'linear-gradient(180deg, #f1c40f 0%, #f39c12 100%)' : '#7f8c8d'),
                        color: isSpinning ? '#bdc3c7' : '#8e44ad', border: '4px solid #fff', borderRadius: '40px',
                        cursor: (isSpinning || balance < SPIN_COST) ? 'not-allowed' : 'pointer',
                        boxShadow: isSpinning ? 'none' : '0 8px 0 #d35400, 0 15px 20px rgba(0,0,0,0.4)',
                        transform: isSpinning ? 'translateY(8px)' : 'none',
                        transition: 'all 0.1s ease', width: '80%'
                    }}
                >
                    {isSpinning ? '–ö—Ä—É—Ç–∏–º...' : `${SPIN_COST} üí∞`}
                </button>
            </div>

            {/* –¢–∞–±–ª–∏—Ü–∞ —à–∞–Ω—Å–æ–≤ (Paytable) */}
            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px', justifyContent: 'center', marginTop: '20px', maxWidth: '400px', fontSize: '12px', zIndex: 10 }}>
                {RARITIES.map(r => (
                    <div key={r.id} style={{ background: 'rgba(0,0,0,0.4)', padding: '6px 12px', borderRadius: '15px', border: `1px solid ${r.color}` }}>
                        {r.icon} {r.name} {r.payout > 0 ? `(+${r.payout})` : ''}: {r.chance}%
                    </div>
                ))}
            </div>

            {/* –ü–æ–ø-–∞–ø —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤—ã–∏–≥—Ä—ã—à–∞ */}
            <div style={{ height: '80px', marginTop: '10px', display: 'flex', alignItems: 'center', zIndex: 10 }}>
                {result && !isSpinning && (
                    <div style={{ animation: 'popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)', textAlign: 'center', background: 'rgba(0,0,0,0.6)', padding: '10px 30px', borderRadius: '20px', border: `2px solid ${result.color}` }}>
                        <div style={{ fontSize: '14px', color: '#bdc3c7', marginBottom: '5px' }}>
                            {result.id === 'nothing' ? '–£–≤—ã...' : '–í–´–ò–ì–†–´–®!'}
                        </div>
                        <div style={{ fontSize: '26px', fontWeight: 'bold', color: result.color, textShadow: `0 0 15px ${result.color}80` }}>
                            {result.name} {result.payout > 0 ? `+${result.payout}üí∞` : ''}
                        </div>
                    </div>
                )}
            </div>

            {/* CSS –ê–Ω–∏–º–∞—Ü–∏–∏ (–í—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä—è–º–æ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç) */}
            <style>
                {`
                    @keyframes spinReel {
                        0% { transform: translateY(0); }
                        100% { transform: translateY(calc(-100% + 100px)); }
                    }
                    @keyframes blink {
                        0%, 100% { background: #f1c40f; box-shadow: 0 0 15px #f1c40f; }
                        50% { background: #e74c3c; box-shadow: 0 0 15px #e74c3c; }
                    }
                    @keyframes coinFall {
                        0% { transform: translateY(0); opacity: 1; }
                        100% { transform: translateY(100vh); opacity: 0; }
                    }
                    @keyframes popIn {
                        0% { transform: scale(0.5) translateY(20px); opacity: 0; }
                        100% { transform: scale(1) translateY(0); opacity: 1; }
                    }
                    
                    /* --- –î–ñ–ï–ö–ü–û–¢ –ê–ù–ò–ú–ê–¶–ò–ò: –ú–Ø–°–û --- */
                    @keyframes jackpotShake {
                        0% { transform: translate(1px, 1px) rotate(0deg); }
                        10% { transform: translate(-1px, -2px) rotate(-1deg); }
                        20% { transform: translate(-3px, 0px) rotate(1deg); }
                        30% { transform: translate(3px, 2px) rotate(0deg); }
                        40% { transform: translate(1px, -1px) rotate(1deg); }
                        50% { transform: translate(-1px, 2px) rotate(-1deg); }
                        60% { transform: translate(-3px, 1px) rotate(0deg); }
                        70% { transform: translate(3px, 1px) rotate(-1deg); }
                        80% { transform: translate(-1px, -1px) rotate(1deg); }
                        90% { transform: translate(1px, 2px) rotate(0deg); }
                        100% { transform: translate(1px, -2px) rotate(-1deg); }
                    }
                    
                    @keyframes jackpotBurst {
                        0% { opacity: 1; transform: translate(-50%, -50%) scale(0.2); }
                        100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
                    }
                    
                    @keyframes jackpotParticleExpand {
                        0% { r: 10; }
                        100% { r: 50; }
                    }
                    
                    @keyframes jackpotCoinSpew {
                        0% { transform: translateY(0) scale(1); opacity: 1; }
                        100% { transform: translateY(200px) scale(0.5); opacity: 0; }
                    }
                `}
            </style>
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./views/HomeView.jsx ===
import React, { useState } from 'react';
import Room3D from '../components/Room3D';

function Takoyaki({ style, onPointerDown, onPointerMove, onPointerUp }) {
    return (
        <div 
            onPointerDown={onPointerDown} onPointerMove={onPointerMove} onPointerUp={onPointerUp}
            style={{
                width: '80px', height: '80px', cursor: 'grab',
                userSelect: 'none', WebkitUserSelect: 'none', touchAction: 'none',
                filter: 'drop-shadow(0px 8px 6px rgba(0,0,0,0.4))',
                ...style
            }}
        >
            <svg viewBox="0 0 100 100" width="100%" height="100%">
                <circle cx="50" cy="50" r="45" fill="#e5b05c" />
                <circle cx="50" cy="50" r="45" fill="url(#takoGrad)" />
                <defs><radialGradient id="takoGrad"><stop offset="40%" stopColor="transparent"/><stop offset="100%" stopColor="rgba(139,69,19,0.4)"/></radialGradient></defs>
                <path d="M 15 45 Q 30 20 60 30 T 85 45 Q 90 70 70 80 T 30 75 Q 10 60 15 45" fill="#4a2511" />
                <path d="M 10 35 Q 50 10 90 45" stroke="#fffacd" strokeWidth="5" fill="none" strokeLinecap="round"/>
                <path d="M 15 55 Q 50 30 85 65" stroke="#fffacd" strokeWidth="5" fill="none" strokeLinecap="round"/>
                <circle cx="35" cy="30" r="2.5" fill="#2e4c16" /><circle cx="65" cy="40" r="3" fill="#2e4c16" />
                <circle cx="45" cy="60" r="2" fill="#2e4c16" /><circle cx="75" cy="60" r="2.5" fill="#2e4c16" />
            </svg>
        </div>
    );
}

export default function HomeView({ character = 'twilight', stats, setStats, sendAction, isGreeting, onFeed }) {
    const [action, setAction] = useState('idle');
    const [isDragging, setIsDragging] = useState(false);
    const [foodPos, setFoodPos] = useState({ x: 0, y: 0 });

    let criticalCount = 0;
    if (stats?.hng <= 15) criticalCount++;
    if (stats?.eng <= 15) criticalCount++;
    if (stats?.md <= 15) criticalCount++;

    let currentAnim = action;
    if (isGreeting) currentAnim = 'hello';
    else if (criticalCount >= 2) currentAnim = 'fall';
    else if (criticalCount === 1 && action !== 'eat') currentAnim = 'sick';

    const handlePointerDown = (e) => {
        if (currentAnim === 'fall') return;
        setIsDragging(true);
        e.target.setPointerCapture(e.pointerId);
    };

    const handlePointerMove = (e) => {
        if (!isDragging) return;
        setFoodPos({ x: e.clientX - 40, y: e.clientY - 40 }); 
    };

    const handlePointerUp = (e) => {
        setIsDragging(false);
        e.target.releasePointerCapture(e.pointerId);
        
        if (e.clientY < window.innerHeight / 2.0 && currentAnim !== 'fall') {
            setAction('eat');
            setStats(prev => ({ ...prev, hng: Math.min(100, prev.hng + 25), eng: Math.max(0, prev.eng - 5) }));
            sendAction('fd');

            // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–ª–ª–±—ç–∫ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è
            if (onFeed) onFeed();

            setTimeout(() => setAction('idle'), 2500);
        }
        setFoodPos({ x: 0, y: 0 }); 
    };

    const scaleMult = character === 'rick' ? 0.2 : 1;

    return (
        <div style={{ width: '100vw', height: '100vh', position: 'relative', overflow: 'hidden', backgroundImage: 'url(/images/kitchen_bg.png)', backgroundSize: 'cover', backgroundPosition: 'center' }}>
            <Room3D url={`/models/${character}/${currentAnim}.glb`} posY={-2.5} scale={2.2 * scaleMult} loop={currentAnim !== 'fall' && currentAnim !== 'hello'} />
            <div style={{ position: 'absolute', bottom: 0, left: 0, width: '100%', height: '25%', display: 'flex', flexDirection: 'column', pointerEvents: 'none', zIndex: 10 }}>
                <div style={{ width: '100%', height: '40px', background: 'linear-gradient(180deg, #deab7a 0%, #c48b53 100%)', borderTop: '4px solid #f2c79b', borderBottom: '8px solid #8c5828' }} />
                <div style={{ width: '100%', height: '20px', background: 'linear-gradient(180deg, rgba(0,0,0,0.4) 0%, transparent 100%)' }} />
                <div style={{ display: 'flex', justifyContent: 'space-around', width: '100%', height: '100%', padding: '0 20%' }}>
                    <div style={{ width: '40px', height: '100%', background: 'linear-gradient(90deg, #5c3a18 0%, #8c5828 20%, #3e2710 100%)', borderLeft: '2px solid #a87242' }} />
                    <div style={{ width: '40px', height: '100%', background: 'linear-gradient(90deg, #5c3a18 0%, #8c5828 20%, #3e2710 100%)', borderLeft: '2px solid #a87242' }} />
                </div>
            </div>
            <Takoyaki 
                onPointerDown={handlePointerDown} onPointerMove={handlePointerMove} onPointerUp={handlePointerUp}
                style={{
                    position: 'absolute', zIndex: 1000, transition: isDragging ? 'none' : 'all 0.3s ease',
                    bottom: isDragging ? 'auto' : '22%', left: isDragging ? `${foodPos.x}px` : 'calc(50% - 40px)', top: isDragging ? `${foodPos.y}px` : 'auto',
                }}
            />
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./App.jsx ===
import React, { useState, useEffect, useRef } from 'react';
import { useGLTF } from '@react-three/drei';

import HomeView from './views/HomeView';
import PlayView from './views/PlayView';
import SleepView from './views/SleepView';
import ToiletView from './views/ToiletView';
import WardrobeView from './views/WardrobeView';
import DevView from './views/DevView';
import SlotsView from './views/SlotsView';
import WheelOfFortune from './components/WheelOfFortune';
import WardrobeModal from './components/WardrobeModal';
import { LoadingScreen, WeatherOverlay, NavButton, StatBar } from './components/SharedUI';
import { SettingsModal, ShopModal, GamesModal, QuestsModal, VoiceModal } from './components/AppModals';
import { loc, initialQuests, ANIMATIONS_LIST } from './config';
import './index.css';
import Tutirial from './components/Tutorial';

export default function App() {
    // –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è API (–±–µ—Ä—ë—Ç—Å—è –∏–∑ .env, –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)
    const API_BASE = import.meta.env.VITE_GO_API_URL || '';

    const [currentView, setCurrentView] = useState('home');
    const [character, setCharacter] = useState('twilight');
    const [isGreeting, setIsGreeting] = useState(true);
    const [showTutorial, setShowTutorial] = useState(false);
    const [petName, setPetName] = useState('–ü–∏—Ç–æ–º–µ—Ü'); 
    const [inputName, setInputName] = useState('');

    const [stats, setStats] = useState({ hng: 100, eng: 100, md: 100, tl: 50 });
    const [balance, setBalance] = useState(1000); 
    const tg = window.Telegram?.WebApp;
    const PLAYER_ID = tg?.initDataUnsafe?.user?.id?.toString() || "test_user_1";

    const [isSettingsOpen, setIsSettingsOpen] = useState(false);
    const [isDevMode, setIsDevMode] = useState(false);
    const [theme, setTheme] = useState(localStorage.getItem('pet_th') || 'drk'); 
    const [language, setLanguage] = useState(localStorage.getItem('pet_lng') || 'ru'); 
    const [city, setCity] = useState(localStorage.getItem('pet_cty') || 'Moscow');
    const [weather, setWeather] = useState('clr'); 
    const [isRescuing, setIsRescuing] = useState(false);

    const [isGamesOpen, setIsGamesOpen] = useState(false);
    const [isShopOpen, setIsShopOpen] = useState(false);
    const [isQuestsOpen, setIsQuestsOpen] = useState(false);
    const [quests, setQuests] = useState(initialQuests);
    const [claimingQuestId, setClaimingQuestId] = useState(null);
    const [isWardrobeOpen, setIsWardrobeOpen] = useState(false);
    const [isWheelOpen, setIsWheelOpen] = useState(false);
    const [unlockedCharacters, setUnlockedCharacters] = useState(['twilight']);

    useEffect(() => {
        if (tg) {
            tg.ready();
            tg.expand();
        }
    }, [tg]);

    const [isVoiceModalOpen, setIsVoiceModalOpen] = useState(false);
    const [isRecording, setIsRecording] = useState(false);
    const [audioUrl, setAudioUrl] = useState(null);
    const [isSending, setIsSending] = useState(false);

    const toiletInterval = useRef(null);
    const isDark = theme === 'drk';
    const l = loc[language];

    const colors = {
        text: isDark ? '#ffffff' : '#2c3e50', glassBg: isDark ? 'rgba(0, 0, 0, 0.4)' : 'rgba(255, 255, 255, 0.4)',
        modalBg: isDark ? 'rgba(30, 30, 30, 0.5)' : 'rgba(255, 255, 255, 0.6)', border: isDark ? 'rgba(255,255,255,0.2)' : 'rgba(255,255,255,0.6)',
        shadow: isDark ? '0 8px 32px rgba(0,0,0,0.5)' : '0 8px 32px rgba(31, 38, 135, 0.15)', textShadow: isDark ? '0 1px 3px rgba(0,0,0,0.8)' : '0 1px 2px rgba(255,255,255,0.8)'
    };

    const sendAction = (actionName, payload = "") => {
        fetch(`${API_BASE}/api/act`, {
            method: 'POST', headers: { 'Content-Type': 'application/json' }, 
            body: JSON.stringify({ uId: PLAYER_ID, act: actionName, pLd: payload })
        })
        .then(res => res.json())
        .then(data => { 
            if (data) {
                setStats({ hng: data.hng, eng: data.eng, md: data.md, tl: data.tl !== undefined ? data.tl : 50 });
                if (data.balance !== undefined) setBalance(data.balance);
                if (data.wth) setWeather(data.wth);

                if (data.tut === 1) setShowTutorial(true);
                else setShowTutorial(false);
                if (data.nm) setPetName(data.nm);
                if (data.unlocked) {
                    try { setUnlockedCharacters(JSON.parse(data.unlocked)); } 
                    catch (e) { console.error("–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞", e); }
                }
            }
        }).catch(err => console.log("–ë—ç–∫–µ–Ω–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω", err));
    };

    useEffect(() => {
        const fetchStats = () => {
            fetch(`${API_BASE}/api/pet?uId=${PLAYER_ID}`).then(res => res.json())
            .then(data => { 
            if (data) {
                setStats({ hng: data.hng, eng: data.eng, md: data.md, tl: data.tl !== undefined ? data.tl : 50 });
                if (data.balance !== undefined) setBalance(data.balance);
                if (data.wth) setWeather(data.wth);
                
                if (data.tut === 1) setShowTutorial(true);
                else setShowTutorial(false);
                if (data.nm) setPetName(data.nm);

                if (data.unlocked) {
                    try { setUnlockedCharacters(JSON.parse(data.unlocked)); } 
                    catch (e) { console.error("–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞", e); }
                }
            }
        }).catch(err => console.log("–ë—ç–∫–µ–Ω–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω", err));
        };
        fetchStats();
        const syncLoop = setInterval(fetchStats, 3000);
        return () => clearInterval(syncLoop);
        
    }, []);

    useEffect(() => {
        localStorage.setItem('pet_unlocked', JSON.stringify(unlockedCharacters));
    }, [unlockedCharacters]);

    useEffect(() => {
        if (currentView === 'toilet') {
            sendAction('toilet_start');
            toiletInterval.current = setInterval(() => {
                setStats(prev => {
                    const newTl = Math.min(100, (prev.tl || 50) + 10);
                    sendAction('toilet_update', newTl.toString());
                    return { ...prev, tl: newTl };
                });
            }, 1000);
        } else {
            if (toiletInterval.current) clearInterval(toiletInterval.current);
            if (currentView !== 'toilet' && currentView !== 'sleep' && currentView !== 'dev' && currentView !== 'slots') sendAction('idle');
        }
        return () => clearInterval(toiletInterval.current);
    }, [currentView]);

    useEffect(() => {
        const isDead = Math.floor(stats.hng) <= 0 && Math.floor(stats.eng) <= 0 && Math.floor(stats.md) <= 0;
        if (isDead && !isRescuing) {
            setIsRescuing(true); setCurrentView('sleep');
            setTimeout(() => { sendAction('heal'); setIsRescuing(false); }, 3000);
        }
    }, [stats, isRescuing]);

    useEffect(() => { localStorage.setItem('pet_th', theme); localStorage.setItem('pet_lng', language); localStorage.setItem('pet_cty', city); }, [theme, language, city]);
    useEffect(() => { ANIMATIONS_LIST.forEach(anim => useGLTF.preload(`/models/${character}/${anim}.glb`)); }, [character]);
    useEffect(() => { const timer = setTimeout(() => setIsGreeting(false), 5000); return () => clearTimeout(timer); }, []);

    const fetchWeather = () => {
        const weathers = ['clr', 'rn', 'snw'];
        const newWth = weathers[Math.floor(Math.random() * 3)];
        setWeather(newWth);
        sendAction('set_wth', newWth);
    };
    const handleGameSelect = () => { setBalance(p => p + 10); sendAction('balance_add', '10'); incrementQuestProgress(4); setIsGamesOpen(false); };
    const handlePurchase = (amount) => { setBalance(p => p + amount); sendAction('balance_add', amount.toString()); incrementQuestProgress(5); setIsShopOpen(false); };
    const incrementQuestProgress = (id) => setQuests(prev => prev.map(q => (q.id === id && !q.completed && !q.claimed) ? { ...q, progress: Math.min(q.progress + 1, q.target), completed: Math.min(q.progress + 1, q.target) >= q.target } : q));
    const claimQuestReward = (questId) => {
        setClaimingQuestId(questId);
        setQuests(prev => prev.map(q => {
            if (q.id === questId && q.completed && !q.claimed) { setBalance(b => b + q.reward); sendAction('balance_add', q.reward.toString()); return { ...q, claimed: true }; }
            return q;
        }));
        setClaimingQuestId(null);
    };

    const startRecording = () => setIsRecording(true);
    const stopRecording = () => { setIsRecording(false); setAudioUrl('test'); };
    const cancelRecording = () => { setIsVoiceModalOpen(false); setAudioUrl(null); setIsRecording(false); };
    const restartRecording = () => setAudioUrl(null);
    const sendRecording = () => { setIsSending(true); setTimeout(() => { setIsSending(false); cancelRecording(); }, 1000); };

    return (
        <div style={{ width: '100vw', height: '100vh', position: 'relative', overflow: 'hidden' }}>
            <LoadingScreen l={l} />
            <WeatherOverlay weather={weather} />

            {currentView === 'home' && <HomeView character={character} stats={stats} setStats={setStats} sendAction={sendAction} isGreeting={isGreeting} onFeed={() => incrementQuestProgress(1)} />}
            {currentView === 'play' && <PlayView character={character} stats={stats} setStats={setStats} sendAction={sendAction} isGreeting={isGreeting} onPet={() => incrementQuestProgress(2)} />}
            {currentView === 'sleep' && <SleepView character={character} stats={stats} setStats={setStats} sendAction={sendAction} />}
            {currentView === 'toilet' && <ToiletView character={character} stats={stats} setStats={setStats} sendAction={sendAction} />}
            {currentView === 'wardrobe' && <WardrobeView character={character} />}
            {currentView === 'slots' && <SlotsView balance={balance} setBalance={setBalance} sendAction={sendAction} />}
            {currentView === 'dev' && isDevMode && <DevView character={character} />}

            <div style={{ position: 'absolute', top: '20px', left: '20px', zIndex: 100, display: 'flex', flexDirection: 'column', gap: '10px' }}>
                <button onClick={() => setIsSettingsOpen(true)} style={{ background: colors.glassBg, border: `1px solid ${colors.border}`, color: colors.text, fontSize: '20px', borderRadius: '15px', width: '45px', height: '45px', boxShadow: colors.shadow, backdropFilter: 'blur(10px)' }}>‚öôÔ∏è</button>
                <button onClick={() => setIsWardrobeOpen(true)} style={{ background: colors.glassBg, border: `1px solid ${colors.border}`, color: colors.text, fontSize: '20px', borderRadius: '15px', width: '45px', height: '45px', boxShadow: colors.shadow, backdropFilter: 'blur(10px)' }}>üëï</button>
                <button onClick={() => setIsGamesOpen(true)} style={{ background: colors.glassBg, border: `1px solid ${colors.border}`, color: colors.text, fontSize: '20px', borderRadius: '15px', width: '45px', height: '45px', boxShadow: colors.shadow, backdropFilter: 'blur(10px)' }}>üéÆ</button>
                <button onClick={() => setIsQuestsOpen(true)} style={{ background: colors.glassBg, border: `1px solid ${colors.border}`, color: colors.text, fontSize: '20px', borderRadius: '15px', width: '45px', height: '45px', boxShadow: colors.shadow, backdropFilter: 'blur(10px)' }}>üìã</button>
            </div>

            {petName && (
                <div style={{ 
                    position: 'absolute', top: '20px', left: '50%', transform: 'translateX(-50%)', 
                    zIndex: 100, background: colors.glassBg, backdropFilter: 'blur(10px)', 
                    border: `1px solid ${colors.border}`, padding: '8px 25px', borderRadius: '20px', 
                    color: colors.text, fontWeight: '900', fontSize: '18px', boxShadow: colors.shadow, 
                    letterSpacing: '2px', textTransform: 'uppercase' 
                }}>
                    {petName}
                </div>
            )}

            <div style={{ position: 'absolute', top: '20px', right: '20px', zIndex: 100, display: 'flex', flexDirection: 'column', alignItems: 'flex-end', gap: '10px' }}>
                <div style={{ display: 'flex', gap: '6px', background: colors.glassBg, backdropFilter: 'blur(10px)', border: `1px solid ${colors.border}`, padding: '8px', borderRadius: '20px', boxShadow: colors.shadow }}>
                    <StatBar icon="üçñ" value={Math.round(stats.hng)} color="#ff6b6b" onClick={() => sendAction('dev_minus_hng')} isInteractive={isDevMode} />
                    <StatBar icon="‚ö°" value={Math.round(stats.eng)} color="#feca57" onClick={() => sendAction('dev_minus_eng')} isInteractive={isDevMode} />
                    <StatBar icon="üíñ" value={Math.round(stats.md)} color="#ff9ff3" onClick={() => sendAction('dev_minus_md')} isInteractive={isDevMode} />
                    <StatBar icon="üöΩ" value={Math.round(stats.tl)} color="#1e90ff" onClick={() => sendAction('dev_minus_tl')} isInteractive={isDevMode} />
                </div>
                <div onClick={() => isDevMode ? sendAction('balance_add', '100') : setIsShopOpen(true)} style={{ background: colors.glassBg, backdropFilter: 'blur(10px)', border: `1px solid ${colors.border}`, padding: '8px 15px', borderRadius: '20px', display: 'flex', alignItems: 'center', gap: '6px', cursor: 'pointer', boxShadow: colors.shadow, color: '#f1c40f', fontWeight: 'bold', fontSize: '16px' }}>
                    <span>üí∞</span><span>{balance}</span>
                </div>
                <button onClick={() => { sendAction('heal'); incrementQuestProgress(3); }} style={{ background: '#2ecc71', border: 'none', color: 'white', padding: '6px 15px', borderRadius: '15px', cursor: 'pointer', fontWeight: 'bold', fontSize: '12px', boxShadow: colors.shadow }}>{l.heal}</button>
            </div>

            <button onClick={() => setIsVoiceModalOpen(true)} style={{ position: 'absolute', bottom: '20%', right: '20px', zIndex: 100, background: colors.glassBg, border: `1px solid ${colors.border}`, color: colors.text, fontSize: '24px', borderRadius: '50%', width: '50px', height: '50px', boxShadow: colors.shadow }}>üé§</button>

            {isSettingsOpen && <SettingsModal onClose={() => setIsSettingsOpen(false)} l={l} colors={colors} theme={theme} setTheme={setTheme} language={language} setLanguage={setLanguage} city={city} setCity={setCity} fetchWeather={fetchWeather} isDark={isDark} isDevMode={isDevMode} setIsDevMode={(val) => {
                if (!val) { setIsDevMode(false); return; }
                const pass = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:");
                const correctPass = import.meta.env.VITE_DEV_PASSWORD || "1235";
                if (pass === correctPass) setIsDevMode(true);
                else if (pass !== null) alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
            }} />}
            {isShopOpen && <ShopModal onClose={() => setIsShopOpen(false)} l={l} colors={colors} handlePurchase={handlePurchase} />}
            {isQuestsOpen && <QuestsModal onClose={() => setIsQuestsOpen(false)} l={l} colors={colors} quests={quests} claimQuestReward={claimQuestReward} claimingQuestId={claimingQuestId} />}
            {isVoiceModalOpen && <VoiceModal onClose={cancelRecording} l={l} colors={colors} isRecording={isRecording} startRecording={startRecording} stopRecording={stopRecording} audioUrl={audioUrl} sendRecording={sendRecording} isSending={isSending} restartRecording={restartRecording} cancelRecording={cancelRecording} />}

            {isGamesOpen && <GamesModal onClose={() => setIsGamesOpen(false)} l={l} colors={colors} handleGameSelect={handleGameSelect} openSlots={() => { setCurrentView('slots'); setIsGamesOpen(false); }} />}

            <WardrobeModal isOpen={isWardrobeOpen} onClose={() => setIsWardrobeOpen(false)} unlockedCharacters={unlockedCharacters} currentCharacter={character} onSelect={(id) => { setCharacter(id); sendAction('set_char', id); setIsWardrobeOpen(false); }} onUnlockRequest={() => { setIsWheelOpen(true); setIsWardrobeOpen(false); }} l={l} colors={colors} />

            <WheelOfFortune isOpen={isWheelOpen} onClose={() => setIsWheelOpen(false)} balance={balance} setBalance={setBalance} sendAction={sendAction} unlockedCharacters={unlockedCharacters} onUnlock={(charId) => { 
                setUnlockedCharacters(prev => {
                    const newList = [...prev, charId];
                    sendAction('unlock_char', JSON.stringify(newList));
                    return newList;
                });
                sendAction('set_char', charId); 
                setCharacter(charId); 
            }} colors={colors} l={l} 
            />

            <div style={{ position: 'absolute', bottom: '2%', left: '5%', right: '5%', display: 'flex', justifyContent: 'space-around', background: colors.glassBg, border: `1px solid ${colors.border}`, padding: '15px', borderRadius: '30px', zIndex: 100, backdropFilter: 'blur(15px)', boxShadow: colors.shadow }}>
                <NavButton icon="üè†" label={l.home} isActive={currentView === 'home'} onClick={() => setCurrentView('home')} colors={colors} />
                <NavButton icon="üéæ" label={l.play} isActive={currentView === 'play'} onClick={() => setCurrentView('play')} colors={colors} />
                <NavButton icon="üåô" label={l.sleep} isActive={currentView === 'sleep'} onClick={() => setCurrentView('sleep')} colors={colors} />
                <NavButton icon="üöΩ" label={l.toilet} isActive={currentView === 'toilet'} onClick={() => setCurrentView('toilet')} colors={colors} />
                {isDevMode && <NavButton icon="üõ†" label="Dev" isActive={currentView === 'dev'} onClick={() => setCurrentView('dev')} colors={colors} />}
            </div>

            {isRescuing && <div style={{ position: 'absolute', top: 0, left: 0, width: '100vw', height: '100vh', background: 'rgba(20,25,40,0.95)', zIndex: 10000, display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center', color: 'white' }}>
                <div style={{ fontSize: '60px', marginBottom: '20px', animation: 'float 2s ease-in-out infinite' }}>üåô</div>
                <h2 style={{ textAlign: 'center', color: '#a29bfe' }}>–ü–∏—Ç–æ–º–µ—Ü –∏—Å—Ç–æ—â–µ–Ω...</h2>
                <div style={{ width: '60%', height: '10px', background: 'rgba(255,255,255,0.1)', borderRadius: '5px', marginTop: '30px', overflow: 'hidden' }}>
                    <div style={{ width: '100%', height: '100%', background: '#a29bfe', animation: 'fillBar 3s linear forwards' }} />
                </div>
            </div>}
            {showTutorial && (
                <div style={{ position: 'absolute', top: 0, left: 0, width: '100vw', height: '100vh', background: 'rgba(20,25,40,0.85)', backdropFilter: 'blur(5px)', zIndex: 15000, display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center', color: 'white', padding: '20px', textAlign: 'center', animation: 'fadeIn 0.5s ease' }}>
                    
                    <div style={{ background: 'linear-gradient(135deg, #34495e, #2c3e50)', border: '2px solid #3498db', borderRadius: '25px', padding: '30px', maxWidth: '400px', boxShadow: '0 20px 50px rgba(0,0,0,0.8)' }}>
                        <h2 style={{ color: '#3498db', marginTop: 0, fontSize: '26px' }}>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
                        
                        <div style={{ display: 'flex', flexDirection: 'column', gap: '15px', textAlign: 'left', fontSize: '15px', marginBottom: '20px' }}>
                            <div>üçñ <b>–°–ª–µ–¥–∏ –∑–∞ —Å—Ç–∞—Ç–∞–º–∏:</b> –ö–æ—Ä–º–∏, –∏–≥—Ä–∞–π –∏ —É–∫–ª–∞–¥—ã–≤–∞–π —Å–ø–∞—Ç—å —Å–≤–æ–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞.</div>
                            <div>üí∞ <b>–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –º–æ–Ω–µ—Ç—ã:</b> –ó–∞—Ö–æ–¥–∏ –≤ —Ä–∞–∑–¥–µ–ª –∏–≥—Ä –∏ –ì–ï–ú–ë–õ–ò –ü–û –°–¢–†–ê–®–ù–û–ú–£!</div>
                            <div>üëï <b>–û—Ç–∫—Ä—ã–≤–∞–π —Å–∫–∏–Ω—ã:</b> –ó–∞–≥–ª—è–Ω–∏ –≤ –≥–∞—Ä–¥–µ—Ä–æ–±, —á—Ç–æ–±—ã –∑–∞–≥–µ–º–±–ª–∏—Ç—å –Ω–æ–≤—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ 3D-–∫–æ—Å—Ç—é–º—ã.</div>
                        </div>

                        <div style={{ background: 'rgba(0,0,0,0.3)', padding: '15px', borderRadius: '15px', border: '1px solid #7f8c8d' }}>
                            <div style={{ fontWeight: 'bold', marginBottom: '10px', color: '#ecf0f1' }}>–ö–∞–∫ –Ω–∞–∑–æ–≤–µ—à—å –ø–∏—Ç–æ–º—Ü–∞?</div>
                            <input 
                                type="text" 
                                value={inputName} 
                                onChange={(e) => setInputName(e.target.value)}
                                placeholder="–í–≤–µ–¥–∏ –∏–º—è..."
                                maxLength={12}
                                style={{ width: '100%', padding: '12px', borderRadius: '12px', border: '2px solid #3498db', outline: 'none', fontSize: '16px', boxSizing: 'border-box', background: '#ecf0f1', color: '#2c3e50', fontWeight: 'bold', textAlign: 'center' }}
                            />
                        </div>

                        <button 
                            onClick={() => { 
                                const finalName = inputName.trim() || '–ü–∏—Ç–æ–º–µ—Ü';
                                sendAction('set_nm', finalName);
                                setPetName(finalName);

                                setShowTutorial(false); 
                                sendAction('tut_dn'); 
                            }} 
                            style={{ marginTop: '25px', width: '100%', padding: '15px', background: 'linear-gradient(180deg, #2ecc71 0%, #27ae60 100%)', color: 'white', border: 'none', borderRadius: '20px', fontSize: '18px', fontWeight: 'bold', cursor: 'pointer', boxShadow: '0 5px 15px rgba(46, 204, 113, 0.4)' }}
                        >
                            –ù–∞—á–∞—Ç—å –∏–≥—Ä—É!
                        </button>
                    </div>
                </div>
            )}
        </div>
    );
}
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./App.css ===
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}

--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./utils/api.js ===
// utils/api.js
const API_URL = import.meta.env.VITE_GO_API_URL || '/api';

const getUserId = () => {
    const tgId = window.Telegram?.WebApp?.initDataUnsafe?.user?.id;
    if (tgId) return tgId.toString();

    let localId = localStorage.getItem('local_user_id');
    if (!localId) {
        localId = 'web_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('local_user_id', localId);
    }
    return localId;
};

export const getPSt = async () => {
    try {
        const rs = await fetch(`${API_URL}/pet?userId=${getUserId()}&_t=${Date.now()}`);
        return await rs.json();
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º:', e);
        return null;
    }
};

export const sndAct = async (action, payload = '') => {
    try {
        const rs = await fetch(`${API_URL}/act`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                userId: getUserId(), 
                action: action, 
                payload: payload 
            })
        });
        return await rs.json();
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è:', e);
        return null;
    }
};
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

=== –§–∞–π–ª: ./config.js ===
export const ANIMATIONS_LIST = ['idle', 'sleep', 'joy_jump', 'hello', 'fall', 'sick', 'eat', 'toilet'];

export const loc = {
    ru: {
        settings: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', theme: '–¢–µ–º–∞', lang: '–Ø–∑—ã–∫', city: '–ì–æ—Ä–æ–¥', devMode: '–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞',
        home: '–î–æ–º–æ–π', play: '–ò–≥—Ä–∞', sleep: '–°–æ–Ω', toilet: '–¢—É–∞–ª–µ—Ç', heal: '–í—ã–ª–µ—á–∏—Ç—å', loading: '–ó–∞–≥—Ä—É–∑–∫–∞...',
        ar: 'AR', games: '–ò–≥—Ä—ã', gamesModalTitle: '–í—ã–±–µ—Ä–∏ –∏–≥—Ä—É', playGame: '–ò–≥—Ä–∞—Ç—å', close: '–ó–∞–∫—Ä—ã—Ç—å',
        closeAd: '–ó–∞–∫—Ä—ã—Ç—å —Ä–µ–∫–ª–∞–º—É', shop: '–ú–∞–≥–∞–∑–∏–Ω', buy: '–ö—É–ø–∏—Ç—å', coins: '–º–æ–Ω–µ—Ç',
        followLink: '–ü–µ—Ä–µ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ (+50 –º–æ–Ω–µ—Ç)',
        quests: '–ó–∞–¥–∞–Ω–∏—è', questsModalTitle: '–ó–∞–¥–∞–Ω–∏—è', claim: '–ü–æ–ª—É—á–∏—Ç—å', completed: '–í—ã–ø–æ–ª–Ω–µ–Ω–æ',
        quest1: '–ü–æ–∫–æ—Ä–º–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞', quest2: '–ü–æ–≥–ª–∞–¥—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞', quest3: '–í—ã–ª–µ—á–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞',
        quest4: '–ü–æ–∏–≥—Ä–∞–π –≤ –∏–≥—Ä—ã', quest5: '–ö—É–ø–∏ –º–æ–Ω–µ—Ç—ã',
        voice: '–ì–æ–ª–æ—Å', voiceModalTitle: '–ì–æ–ª–æ—Å–æ–≤–æ–µ –æ–±—â–µ–Ω–∏–µ', startRecord: '–ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å',
        stopRecord: '–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å', send: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å', restart: '–ó–∞–Ω–æ–≤–æ', cancel: '–û—Ç–º–µ–Ω–∞',
        recording: '–ò–¥—ë—Ç –∑–∞–ø–∏—Å—å...', thinking: '–î—É–º–∞—é...', reasoning: '–†–∞—Å—Å—É–∂–¥–∞—é...',
        viewFull: '–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å—ë',
        tl: '–¢—É–∞–ª–µ—Ç', wheel: '–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã', wardrobe: '–ì–∞—Ä–¥–µ—Ä–æ–±',
        changeClothes: '–ü–µ—Ä–µ–æ–¥–µ—Ç—å—Å—è', characters: '–ü–µ—Ä—Å–æ–Ω–∞–∂–∏', unlock: '–ü–æ–ª—É—á–∏—Ç—å', locked: '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ'
    },
    en: {
        settings: 'Settings', theme: 'Theme', lang: 'Language', city: 'City', devMode: 'Developer Mode',
        home: 'Home', play: 'Play', sleep: 'Sleep', toilet: 'Toilet', heal: 'Heal', loading: 'Loading...',
        ar: 'AR', games: 'Games', gamesModalTitle: 'Choose game', playGame: 'Play', close: 'Close',
        closeAd: 'Close ad', shop: 'Shop', buy: 'Buy', coins: 'coins',
        followLink: 'Follow link (+50 coins)',
        quests: 'Quests', questsModalTitle: 'Quests', claim: 'Claim', completed: 'Completed',
        quest1: 'Feed the pet', quest2: 'Pet the pet', quest3: 'Heal the pet',
        quest4: 'Play games', quest5: 'Buy coins',
        voice: 'Voice', voiceModalTitle: 'Voice chat', startRecord: 'Start recording',
        stopRecord: 'Stop', send: 'Send', restart: 'Restart', cancel: 'Cancel',
        recording: 'Recording...', thinking: 'Thinking...', reasoning: 'Reasoning...',
        viewFull: 'View full',
        tl: 'Toilet', wheel: 'Wheel of Fortune', wardrobe: 'Wardrobe',
        changeClothes: 'Change clothes', characters: 'Characters', unlock: 'Unlock', locked: 'Locked'
    }
};

export const initialQuests = [
    { id: 1, titleKey: 'quest1', description: '10 —Ä–∞–∑', target: 10, reward: 50, progress: 0, completed: false, claimed: false },
    { id: 2, titleKey: 'quest2', description: '20 —Ä–∞–∑', target: 20, reward: 70, progress: 0, completed: false, claimed: false },
    { id: 3, titleKey: 'quest3', description: '10 —Ä–∞–∑', target: 10, reward: 150, progress: 0, completed: false, claimed: false },
    { id: 4, titleKey: 'quest4', description: '5 —Ä–∞–∑', target: 5, reward: 100, progress: 0, completed: false, claimed: false },
    { id: 5, titleKey: 'quest5', description: '1 —Ä–∞–∑', target: 1, reward: 200, progress: 0, completed: false, claimed: false },
];
--- –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ ---

